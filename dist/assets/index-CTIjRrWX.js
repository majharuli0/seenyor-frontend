import{b0 as he,b1 as ge,r as n,j as e,b2 as be,b3 as Y,b4 as Ne,z as B,b5 as F,b6 as _e,b7 as je,$ as ce,S as de,G as V,u as te,b8 as ye,_ as Se,az as Ae,b9 as Ce,H as ue,ba as ve,T as Ee,bb as Te,bc as ke,K as De,C as me,N as we,g as Ue,O as xe,bd as Oe,W as Me,a0 as Ie,X as Pe,Y as Re,Z as Le}from"./index-CR4fhODd.js";import{D as $e}from"./index-C3zqOI4w.js";import{A as He}from"./index-DDcXbrpl.js";import{S as Be,A as Fe}from"./Sort-C4l355fM.js";import{C as J}from"./CustomInput-B54BPh_e.js";import{d as Ve,u as qe,a as ze,C as We}from"./CreateAndEditUsers-Dtf0D2Ik.js";import{i as ee}from"./request-BcXuuXiC.js";import{A as ie}from"./AdminSupportAgentTableAction-CgZRwmNf.js";import{E as Ze}from"./Elderly-D0FlUEqh.js";const Xe=({modalOPen:a,setModalOpen:l,role:N="",getlist:_,item:r={},distributorId:v="",changeParams:u={}})=>{const{register:o,handleSubmit:t,formState:{errors:m},reset:i,setValue:y,getValues:O,watch:D,control:j}=he({defaultValues:{testArray:[]}}),{fields:w,append:S}=ge({control:j,name:"testArray"});D("Nursing Home");const[b,c]=n.useState("Create Elderly"),[p,s]=n.useState("Create Elderly"),[R,se]=n.useState("create"),[ne,ae]=n.useState([]),[le,re]=n.useState([]),[q,I]=n.useState(!1),[L,z]=n.useState("");n.useEffect(()=>{if(a)if(ee(r))i({testArray:[]}),c("Create Elderly"),s("Create Elderly"),setTimeout(()=>{S({roomNumber:void 0,firstName:void 0,lastName:void 0})},100);else{i({testArray:[]}),z(r.role),c("Edit Elderly"),s("Save");const{roomNumber:f,firstName:h,lastName:x}=r;console.log("oitem",r.roomNumber,r.firstName,r.lastName),setTimeout(()=>{S({roomNumber:f,firstName:h,lastName:x})},500)}},[a]);const P=f=>{if(ee(r))ze([...f.guests]).then(h=>{(h==null?void 0:h.code)=="00000"&&(B.custom(x=>e.jsx(F,{t:x,text:`${r.role} has been created Successfully!`})),l(!1),_(),i())});else{let h=f.guests[0];qe({...h,id:r.id}).then(x=>{(x==null?void 0:x.code)=="00000"&&(B.custom(A=>e.jsx(F,{t:A,text:"Modified successfully"})),l(!1),_(),i())})}},$=()=>{I(!0)};function W(f){const h={A:"roomNumber",B:"firstName",C:"lastName"};return Object.keys(f).reduce((x,A)=>{var T;const E=A.charAt(0),C=A.slice(1),X=h[E]||E;return x[`row${C}`]=x[`row${C}`]||{},x[`row${C}`][X]=(T=f[A])==null?void 0:T.v,x},{})}const Z={showUploadList:!1,beforeUpload:!1,onChange:f=>{f.file;let h=!0,x=f.file;if(x.status!=="error")return;const A=new FileReader;A.readAsBinaryString(x.originFileObj),A.onload=function(E){try{h=!1;const C=E.target.result;let T=je.read(C,{type:"binary"}).Sheets.Sheet1;delete T["!margins"],delete T["!ref"];let U=Object.values(W(T));U.shift(),U.forEach((H,G)=>{S(H)});return}catch{return}}}},M=()=>ee(r)?e.jsx(_e,{className:"w-full",...Z,children:e.jsx("button",{type:"button",style:{width:"518px"},className:"mt-[10px] font-[500] text-[14px] h-[40px] w-full hover:border-primary hover:text-primary duration-300 px-5 rounded-[10px] bg-transparent text-[#666D90] border border-gray-300",children:"Import from File"})}):e.jsx("div",{onClick:()=>$(),className:"hover:brightness-110 duration-300  cursor-pointer mt-[7px] w-full text-center pt-[12px] pb-[12px]  pt-[7px] text-onBackWarring rounded-[10px] border border-onBackWarring pt-[7px] ",children:"Delete Distributor"}),g=async()=>{I(!1),Ve({id:r.id}),await _(),setTimeout(()=>{l(!1),B.custom(f=>e.jsx(F,{t:f,text:`${r.role} has been successfully deleted`}))},900)};return e.jsxs(be,{modalOPen:a,setModalOpen:l,handleSubmit:t(P),handalDelete:$,width:590,title:b,cstatus:R,id:r==null?void 0:r.id,Foot:e.jsx(M,{}),buttonText:p,children:[w.map((f,h)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Y,{name:`guests[${h}].roomNumber`,control:j,defaultValue:f.roomNumber,render:({field:x})=>e.jsx(J,{label:"Room Number",type:"text",register:o(`guests[${h}].roomNumber`,{required:{value:!0,message:"Please enter Room Number"}}),error:m.roomNumber,placeholder:"Enter Room Number"})}),e.jsx(Y,{name:`guests[${h}].firstName`,control:j,defaultValue:f.firstName,render:({field:x})=>e.jsx(J,{label:"firstName",type:"text",register:o(`guests[${h}].firstName`,{required:{value:!0,message:"Please enter first name"}}),error:m.firstName,placeholder:"Enter firstName"})}),e.jsx(Y,{name:`guests[${h}].lastName`,control:j,defaultValue:f.lastName,render:({field:x})=>e.jsx(J,{label:"lastName",type:"text",register:o(`guests[${h}].lastName`,{required:{value:!0,message:"Please enter lastName"}}),error:m.lastName,placeholder:"Enter lastName"})})]},h)),e.jsx(Ne,{onDelete:()=>g(),modalOPen:q,setModalOpen:I,title:`Are you sure to delete this ${L} account? This`,title2:" process CANâ€™T be undo."})]})},Ge=a=>{const{data:l,handleEmitEvet:N}=a,[_,r]=n.useState(!1),[v,u]=n.useState(!1),o=n.useContext(ce),{rolesFormatter:t}=n.useContext(de),[m,i]=n.useState(l==null?void 0:l.role),[y,O]=n.useState(V.get("user"));te();const D=b=>{u(b)},j=()=>{i(l.role),r(!0),u(!1)},w=e.jsx("div",{className:"w-fit p-2",children:e.jsx("button",{onClick:()=>{j()},disabled:l==null?void 0:l.is_default,className:"text-sm w-full flex disabled:opacity-50 disabled:cursor-not-allowed  items-start rounded-[10px] font-medium text-light-black hover:bg-black/10 hover:text-primary py-3 px-5",children:"Set as Default Agent"})}),S=async()=>{Ce({sales_agent_id:l==null?void 0:l._id,office_id:y==null?void 0:y._id}).then(b=>{B.custom(c=>e.jsx(F,{t:c,text:b.message})),o==null||o.getlist()}).catch(b=>{console.log(b)})};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx("div",{children:e.jsx(ye,{open:v,onOpenChange:D,content:w,placement:"leftTop",trigger:"click",children:e.jsx("button",{className:" hover:bg-primary/10 rounded-full w-[40px] h-[40px] flex items-center justify-center",children:e.jsx("span",{dangerouslySetInnerHTML:{__html:Se.sanitize(`<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22" fill="none">
<path d="M11 4.875C11.3452 4.875 11.625 5.15482 11.625 5.5C11.625 5.84518 11.3452 6.125 11 6.125C10.6548 6.125 10.375 5.84518 10.375 5.5C10.375 5.15482 10.6548 4.875 11 4.875ZM11 10.375C11.3452 10.375 11.625 10.6548 11.625 11C11.625 11.3452 11.3452 11.625 11 11.625C10.6548 11.625 10.375 11.3452 10.375 11C10.375 10.6548 10.6548 10.375 11 10.375ZM11 15.875C11.3452 15.875 11.625 16.1548 11.625 16.5C11.625 16.8452 11.3452 17.125 11 17.125C10.6548 17.125 10.375 16.8452 10.375 16.5C10.375 16.1548 10.6548 15.875 11 15.875Z" fill="#666D90" stroke="#666D90" stroke-width="1.5"/>
</svg>`)}})})})})}),e.jsx(Ae,{role:m,onOk:()=>S(),modalOPen:_,setModalOpen:r,title:`Are you sure to set this ${t==null?void 0:t[l==null?void 0:l.role]} as default agent? This`,title2:"can be changed latter."})]})};function Ke({row:a}){const[l,N]=n.useState(a==null?void 0:a.status),[_,r]=n.useState(!1),v=u=>{r(!0),xe(a==null?void 0:a._id,{status:u}).then(o=>{var t;console.log(o),o&&N((t=o==null?void 0:o.user)==null?void 0:t.status)}).finally(()=>{r(!1)})};return n.useEffect(()=>{N(a==null?void 0:a.status)},[a]),e.jsx(me,{theme:{token:{colorText:"#707EAE",colorPrimary:"#06A44F",colorLinkActive:"#8086AC",colorLinkHover:"#8086AC",colorLink:"#8086AC"}},children:e.jsx(we,{loading:_,onChange:v,handleBg:"#00000",className:"bg-slate-200",value:l})})}function Qe({row:a}){const[l,N]=n.useState(a==null?void 0:a.status),[_,r]=n.useState(!1),v=u=>{r(!0),xe(a==null?void 0:a._id,{status:u}).then(o=>{var t;console.log(o),o&&N((t=o==null?void 0:o.user)==null?void 0:t.status)}).finally(()=>{r(!1)})};return n.useEffect(()=>{N(a==null?void 0:a.status)},[a]),e.jsxs("div",{className:"flex items-center space-x-2 mr-0 ",children:[e.jsx("span",{className:`w-3 h-3 rounded-full relative -right-2 ${l==!0?"bg-[#1EB564]":"bg-red-500"}`}),e.jsx(me,{theme:{token:{colorText:"#707EAE",colorPrimary:"#8086AC",colorLinkActive:"#8086AC",colorLinkHover:"#8086AC",colorLink:"#8086AC"}},children:e.jsx(Ue,{value:l,variant:"borderless",onChange:v,loading:_,dropdownMatchSelectWidth:!1,optionSelectedColor:"#8086AC",className:"w-fit !text-red-100",options:[{value:!1,label:e.jsx("span",{children:"Disable"})},{value:!0,label:e.jsx("span",{children:"Active"})}]})})]})}const Ye=a=>{const[l,N]=n.useState(V.get("mainRole")),[_,r]=n.useState(void 0),{setUserDetil:v}=ue();te(),console.log(a);const u={distributor:{office:["name","address","contact_person","contact_number","end_user_count","nursing_home_count","monitoring_company_count","action"],sales_agent:["name","address","contact_number","agent_id","nursing_home_count","monitoring_company_count","end_user_count","action"]},sales_agent:{nursing_home:["name","address","contact_person","contact_number","assigned_nurse_count","action"],end_user:["name","address","contact_number"],monitoring_station:["name","address","contact_person","contact_number","action"],installer:["name","address","contact_number","action"],support_agent:["name","address","contact_number","action"]},nursing_home:{nurse:["name","contact_number","action"],elderly:["elderlyName","activeAlert","allergies","diseases","viewOnMap"],end_user:["name","address","created_date","contact_number","devices","expiry","nursing_home_action"]},monitoring_station:{support_agent:["name","address","contact_number","action"],installer:["name","address","contact_number","action"],elderly:["elderlyName","activeAlert","allergies","diseases","viewOnMap"]},nurse:{elderly:["name","age","alert_count","device_count"]},installer:{end_user:["name","address","contact_number","action"]},office:{sales_agent:["name","address","contact_number","agent_id","is_default","nursing_home_count","monitoring_company_count","end_user_count","device_count","sales_agent_action"],installer:["name","address","contact_number","action"]}},o={name:{title:t=>{switch(t){case"office":return"Office";case"nurse":return"Nurse Name";case"distributor":return"Distributor Name";case"sales_agent":return"Sales Agent Name";case"nursing_home":return"Nursing Home";case"end_user":return"User Name";case"monitoring_station":return"Control Center";case"support_agent":return"Support Agent";case"installer":return"Installer";default:return"Name"}},key:"id",render:t=>(t==null?void 0:t.role)=="elderly"?e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.name})}):e.jsx("button",{children:e.jsx(De,{data:t})})},elderlyName:{title:"Elderly Name",render:t=>e.jsx(Ze,{data:t})},address:{title:t=>{switch(t){case"sales_agent":return"Address";default:return"Address"}},render:t=>e.jsx("button",{style:{width:"200px",textAlign:"left"},children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.address})})},installation_address:{title:"Installation Address",render:t=>e.jsx("button",{style:{width:"200px",textAlign:"left"},children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.installation_address})})},activeAlert:{title:"Active Fall Alerts",dataIndex:"unresolved_alarm_count",render:t=>e.jsx("span",{children:t})},allergies:{title:"Comments",render:t=>{var m;return e.jsx("span",{children:((m=t==null?void 0:t.comments)==null?void 0:m.map(i=>i.comment).join(", "))||"N/A"})}},diseases:{title:"Conditions",render:t=>{var m;return e.jsx("span",{children:((m=t==null?void 0:t.diseases)==null?void 0:m.map(i=>i).join(", "))||"N/A"})}},medications:{title:"Medications",render:t=>{var m;return e.jsx("span",{children:(m=t.medications)==null?void 0:m.map(i=>i.name).join(", ")})}},viewOnMap:{title:"View On Map",render:t=>e.jsx("span",{className:"flex items-center transition-all duration-300 justify-start gap-2 text-sm font-medium text-text-primary hover:text-primary cursor-pointer p-2 rounded-md w-fit text-center hover:bg-slate-100",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("a",{href:`https://www.google.com/maps?q=${t.latitude},${t.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"text-base font-medium !text-blue-500",children:"View on Map"}),e.jsx(ke,{size:18,className:"text-blue-500"})]})})},email:{title:"Email Address",render:t=>e.jsx("button",{style:{width:"150px",textAlign:"left"},children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.email})})},expiry:{title:"Is Expire",render:t=>e.jsx("button",{style:{width:"150px",textAlign:"left"},children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.expired})})},devices:{title:"Total Devices",render:t=>e.jsx("button",{style:{width:"150px",textAlign:"left"},children:e.jsxs("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:[t.devices||0,"x"]})})},contact_number:{title:"Contact Number",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.contact_code+" "+t.contact_number})})},contact_person:{title:"Contact Person",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.contact_person})})},date:{title:"Date of Sales",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.date})})},created_date:{title:"User Since",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:Te(t.created_at)})})},age:{title:"Age",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.age})})},external_id:{title:"External ID",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.date})})},products:{title:"Products",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.products})})},products_price:{title:"Products Price",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.products_price})})},addons:{title:"Addons",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.addons})})},addons_price:{title:"Addons Price",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.addon_price})})},total_price:{title:"Total Price",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.total})})},alert_count:{title:"Alert Count",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.alert_count})})},device_count:{title:"Device Count",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.device_count})})},sales_agent_count:{title:"Sales Agents",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.sales_agent_count})})},end_user_count:{title:"End Users",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.end_user_count})})},nursing_home_count:{title:"Nursing Homes",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.nursing_home_count})})},monitoring_company_count:{title:"Control Center",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.monitoring_station_count})})},assigned_nurse_count:{title:"Assigned Nurse",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t==null?void 0:t.nurse_count})})},office_name:{title:"Office",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.office_name})})},is_default:{title:"Default Agent",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.is_default?e.jsx(Ee,{color:"purple",children:"Default Agent"}):""})})},installer:{title:"Installer Name",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.installer_name})})},agent_id:{title:"Agent ID",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.agent_id})})},status:{title:"Status",render:t=>(t==null?void 0:t.role)=="sales_agent"?e.jsx(Ke,{row:t}):e.jsx(Qe,{row:t})},report:{title:"Report",render:t=>e.jsx("div",{className:"flex justify-center",children:e.jsx(ve,{report:t})})},status2:{title:"Installation Status",render:t=>{let m;switch(t.status){case"not started":m="bg-gray-500";break;case"problem":m="bg-red-500";break;case"pending":m="bg-yellow-500";break;case"complete":m="bg-[#1EB564]";break}return e.jsx("button",{children:e.jsx("span",{className:`text-[14px] xl:text-base capitalize font-semibold font-normal text-white p-2 px-3 ${m} rounded-lg`,children:t.status})})}},action:{title:"",key:"id",width:100,render:t=>e.jsx(ie,{data:t})},nursing_home_action:{title:"",key:"id",width:100,render:t=>e.jsx(ie,{data:t})},sales_agent_action:{title:"",key:"id",width:100,render:t=>e.jsx(Ge,{data:t})}};return n.useEffect(()=>{var t,m,i,y,O,D,j,w,S;if(a=="Offices"){const c=(((t=u[l])==null?void 0:t.office)||[]).map(p=>{const s=o[p];return{...s,title:s&&typeof s.title=="function"?s.title("office"):s==null?void 0:s.title}});r(c)}else if(a=="Support Agents"){const c=(((m=u[l])==null?void 0:m.support_agent)||[]).map(p=>{const s=o[p];return{...s,title:s&&typeof s.title=="function"?s.title("support_agent"):s==null?void 0:s.title}});r(c)}else if(a=="Nursing Homes"){const c=(((i=u[l])==null?void 0:i.nursing_home)||[]).map(p=>{const s=o[p];return{...s,title:s&&typeof s.title=="function"?s.title("nursing_home"):s==null?void 0:s.title}});r(c)}else if(a=="Sales Agents"){const c=(((y=u[l])==null?void 0:y.sales_agent)||[]).map(p=>{const s=o[p];return{...s,title:s&&typeof s.title=="function"?s.title("sales_agent"):s==null?void 0:s.title}});r(c)}else if(a=="End Users"){const c=(((O=u[l])==null?void 0:O.end_user)||[]).map(p=>{const s=o[p];return{...s,title:s&&typeof s.title=="function"?s.title("end_user"):s==null?void 0:s.title}});r(c)}else if(a=="Installers"){const c=(((D=u[l])==null?void 0:D.installer)||[]).map(p=>{const s=o[p];return{...s,title:s&&typeof s.title=="function"?s.title("installer"):s==null?void 0:s.title}});r(c)}else if(a=="Control Centers"){const c=(((j=u[l])==null?void 0:j.monitoring_station)||[]).map(p=>{const s=o[p];return{...s,title:s&&typeof s.title=="function"?s.title("monitoring_station"):s==null?void 0:s.title}});r(c)}else if(a=="Nurse"){console.log(a);const c=(((w=u[l])==null?void 0:w.nurse)||[]).map(p=>{const s=o[p];return{...s,title:s&&typeof s.title=="function"?s.title("nurse"):s==null?void 0:s.title}});r(c)}else if(a=="Elderly"){const c=(((S=u[l])==null?void 0:S.elderly)||[]).map(p=>{const s=o[p];return{...s,title:s&&typeof s.title=="function"?s.title("elderly"):s==null?void 0:s.title}});r(c)}},[a]),_};let Je={NursingHomes:{placeholder:"Search Nursing Home",btnName:"Add New Nursing Home",menuName:"Nursing Homes",role:"nursing_home"},SalesAgents:{placeholder:"Search Sales Agents",btnName:"Add New Sales Agent",menuName:"Sales Agents",role:"sales_agent"},Offices:{placeholder:"Search Office",btnName:"Add New Office",menuName:"Offices",role:"office"},SupportAgents:{placeholder:"Search Support Agents",btnName:"Add New Support Agents",menuName:"Support Agents",role:"supports_agent"},EndUsers:{placeholder:"Search End User",btnName:"Add New End User",menuName:"End Users",role:"end_user"},ControlCenters:{placeholder:"Search Control Center",btnName:"Add New Control Center",menuName:"Control Centers",role:"monitoring_station"},Installers:{placeholder:"Search Installers",btnName:"Add New Installer",menuName:"Installers",role:"installer"},Nurse:{placeholder:"Search Nurse",btnName:"Add New Nurse",menuName:"Nurse",role:"nurse"},Elderly:{placeholder:"Search Elderly",btnName:"",menuName:"Elderlies",role:"elderly"}};function ct(){const{setUserDetil:a}=ue();te(),n.useRef(!1);const[l,N]=n.useState({}),[_,r]=n.useState("Dashboard"),{role:v}=n.useContext(de),[u,o]=n.useState(V.get("mainRole")),[t,m]=n.useState(!1),[i,y]=n.useState(""),[O,D]=n.useState(""),[j,w]=n.useState("Add New Support Agent"),[S,b]=n.useState(""),[c,p]=n.useState("Time"),[s,R]=n.useState(!1),[se,ne]=n.useState(!1),[ae,le]=n.useState([]),[re,q]=n.useState({}),[I,L]=n.useState([]),[z,P]=n.useState(0),[$,W]=n.useState("Search Nursing Home"),oe=["Time","Name"],[Z,M]=n.useState(!1),[g,f]=n.useState({}),[h,x]=n.useState([]),A=()=>{R(!0)},E=Ye(i);n.useEffect(()=>{E&&L(E)},[E,i]);const[C,X]=n.useState(V.get("user")),T=n.useCallback(()=>{r("Users"),L(E);let d=u||C.role;const k={nursing_home:{menus:[{text:"Nurse"},{text:"Elderly"},{text:"End Users"}],activeTab:"Nurse"},distributor:{menus:[{text:"Offices"},{text:"Sales Agents"}],activeTab:"Offices"},office:{menus:[{text:"Sales Agents"},{text:"Installers"}],activeTab:"Sales Agents"},sales_agent:{menus:[{text:"End Users"},{text:"Nursing Homes"},{text:"Control Centers"},{text:"Installers"},{text:"Support Agents"}],activeTab:"End Users"},monitoring_station:{menus:[{text:"Elderly"},{text:"Installers"},{text:"Support Agents"}],activeTab:"Elderly"},nurse:{menus:[{text:"Elderly"}],activeTab:"Elderly"},installer:{menus:[{text:"End Users"}],activeTab:"End Users"}};if(k[d]){const{menus:K,activeTab:Q}=k[d];le(K),y(Q)}},[u,v]),U=n.useCallback(()=>{if(!(!g||i==""))if(M(!0),["monitoring_station","installer"].includes(u)&&i==="End Users")delete g.role,Oe({...g,...l}).then(d=>{x(d.data),P(d.total)}).catch(d=>{console.error("Error fetching users:",d)}).finally(()=>{M(!1)});else if(["nursing_home","monitoring_station"].includes(u)&&i==="Elderly")delete g.role,Me({...g,...l}).then(d=>{x(d.data),P(d.total)}).catch(d=>{console.log(d)}).finally(()=>{M(!1)});else{if(!g.role)return;Ie({...g,...l}).then(d=>{x(d.data),P(d.total)}).catch(d=>{d.code==="ECONNABORTED"?console.error("Request timed out"):console.error("Error fetching users:",d)}).finally(()=>{M(!1)})}},[g,i,u]),H=n.useCallback(()=>{const d=i.replace(/\s/g,""),k=Je[d];if(k){const{placeholder:K,btnName:Q,menuName:pe,role:fe}=k;W(K),w(Q),D(pe),f({...g,role:fe}),N({...l,page:1}),q({nursingHomeId:C.id})}else console.warn(`Role "${d}" not found in roleConfig.`)},[i]);n.useEffect(()=>{T()},[T]),n.useEffect(()=>{H()},[H]),n.useEffect(()=>{U()},[U]),n.useEffect(()=>{c&&g.orderType!==c&&(delete g.sort_by_created_at,delete g.sort_by_name,f({...g,...c==="Name"?{sort_by_name:-1}:{sort_by_created_at:-1}}),N({...l,page:1}))},[c]);const G=n.useCallback(Pe(d=>{f(k=>({...k,search:d.trim()})),N(k=>({...k,page:1}))},800),[]);return n.useEffect(()=>()=>{G.cancel()},[]),e.jsxs("div",{className:"",children:[e.jsx("div",{className:"py-[20px] flex",children:e.jsx($e,{menus:ae,activeTab:i,setActiveTab:y})}),e.jsx("div",{className:"",children:["Support Agents","Nursing Homes","Sales Agents","Offices","End Users","Control Centers","Installers","Nurse","Elderly"].includes(i)&&e.jsxs("div",{children:[e.jsxs("div",{className:" bg-white rounded-2xl overflow-hidden",children:[e.jsxs("div",{className:" px-[22px] py-6 flex items-start flex-col lg:flex-row justify-between gap-2",children:[e.jsx("div",{className:" flex items-center justify-between w-full",children:e.jsx("h2",{className:" text-2xl font-bold text-text-primary",children:O})}),e.jsxs("div",{className:" flex items-center justify-end gap-5 w-full",children:[e.jsx(Re,{search:S,setSearch:d=>{b(d),G(d)},placeholder:$}),!["Elderly"].includes()&&!["nursing_home"].includes(u)&&e.jsx(Be,{query:g,setQuery:f,selected:c,setSelected:p,data:oe}),!(["Elderly","Sales Agents","End Users"].includes(i)&&["installer","monitoring_station","office","sales_agent","nursing_home"].includes(u))&&!0||i==="End Users"&&u==="nursing_home"?e.jsxs(Le,{onClick:()=>A(),className:"hidden lg:flex min-w-[80px]",children:[e.jsx(He,{})," ",j]}):null]})]}),e.jsx("div",{className:" grid grid-cols-1",children:e.jsx(ce.Provider,{value:{role:g.role,getlist:U,query:g,total:z,page:l,SetPage:d=>{N(d)}},children:e.jsx(Fe,{loading:Z,tableData:h,columns:I,getlist:U})})})]}),e.jsx(We,{item:{},changeParams:re,getlist:U,role:g.role,modalOPen:s,setModalOpen:R,parentID:C._id})]})}),e.jsx(Xe,{modalOPen:se,setModalOpen:ne})]})}export{ct as default};
