import{r as o,S as L,j as i,t as D,E as k}from"./index-CR4fhODd.js";const O=({alarmEvents:p=[],enterBedTime:x,getupAfterTime:f,noDataText:E="No data available to show"})=>{const{sleepEventsType:a,sleepEventsColor:m}=o.useContext(L),l=o.useMemo(()=>p.map(e=>{const t=Object.prototype.hasOwnProperty.call(a,e.event_type)?a[e.event_type]:void 0;return{id:`${e.event_type}-${e.ts}`,name:t,startTime:new Date(e.ts),endTime:new Date(e.ts),color:t&&Object.prototype.hasOwnProperty.call(m,t)?m[t]:void 0}}).filter(e=>e.name),[p,a,m]),w=[11,12,13,14,15],d=o.useMemo(()=>w.map(e=>a[e]).filter(Boolean),[a]),[n,y]=o.useState(()=>d.reduce((e,t)=>(e[t]=!0,e),{}));o.useEffect(()=>{const e=d.filter(t=>!(t in n));e.length>0&&y(t=>({...t,...e.reduce((s,r)=>({...s,[r]:!0}),{})}))},[d,n]);const S=e=>{y(t=>({...t,[e]:!t[e]}))},h=o.useMemo(()=>l.filter(e=>n[e.name]),[l,n]),j=Math.min(...l.map(e=>e.startTime.getTime())),v=Math.max(...l.map(e=>e.endTime.getTime())),$=o.useMemo(()=>h.map((e,t)=>{const s=e.startTime.getTime()===e.endTime.getTime();return{id:t,name:e.name,value:[e.startTime.getTime(),e.endTime.getTime(),s?15:10],itemStyle:{color:e.color}}}),[h]);if(l.length===0)return i.jsx(D,{description:E});const M={tooltip:{trigger:"item",formatter:e=>{const t=h[e.data.id],s=t.startTime.getTime()===t.endTime.getTime(),r=new Date(t.startTime).toLocaleString();if(s)return`${t.name}<br/>Date & Time: ${r}`;{const c=new Date(t.endTime).toLocaleString(),g=t.endTime-t.startTime,u=Math.floor(g/(1e3*60)),T=Math.floor(u/60),b=u%60,C=T>0?`${T} hour(s) ${b} minute(s)`:`${b} minute(s)`;return`<b>${t.name}</b> <br/>Start: ${r}<br/>End: ${c}<br/>Duration: ${C}`}}},grid:{left:"5%",right:"5%",bottom:"15%",containLabel:!1},xAxis:{type:"time",boundaryGap:!0,min:j,max:v,splitNumber:5,axisLabel:{formatter:e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),interval:0,margin:5},axisTick:{show:!0,alignWithLabel:!0}},yAxis:{show:!1},series:[{name:"Events",type:"custom",renderItem:(e,t)=>{const s=t.coord([t.value(0),0]),r=t.coord([t.value(1),0]),c=t.size([0,t.value(2)])[1],g=Math.max(r[0]-s[0],5);e.coordSys.height-c,e.dataIndex%5;const u=e.coordSys.height-c+60;return{type:"rect",shape:{x:s[0],y:u,width:g,height:c},style:{fill:t.style().fill,stroke:"#fff",lineWidth:1}}},encode:{x:[0,1]},data:$}],graphic:x&&f?[{type:"text",left:"5%",bottom:"1%",style:{text:`Enter Bed ${x}`,fontSize:12}},{type:"text",right:"5%",bottom:"1%",style:{text:`Getup ${f}`,fontSize:12}}]:[]};return i.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 w-full",children:[i.jsx("div",{id:"customLegend",className:"w-full",children:i.jsx("div",{className:"flex flex-wrap gap-4 items-center justify-center",children:d.map(e=>i.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>S(e),children:[i.jsx("div",{id:"legendColorShape",className:"size-3 rounded-[4px] border-2",style:{backgroundColor:n[e]?m[e]:"grey",borderColor:n[e]?"transparent":"#ccc"}}),i.jsx("div",{children:e})]},e))})}),i.jsx(k,{option:M,style:{height:200,width:"100%"}})]})};export{O as default};
