import{r as l,l as je,S as te,u as w,j as e,m as G,n as be,o as ye,T as k,B as D,P as Se,p as Ne,q as ve,s as se,t as F,v as Ce,w as Y,x as Ae,y as Ee,z as Z,A as Me,G as V,H as ke,J as K,K as Le,C as ne,N as Ue,g as Oe,O as re,Q as X,U as Pe,V as Re,W as Ie,X as Te,Y as He,Z as $e,_ as we,$ as De,a0 as ze}from"./index-CR4fhODd.js";import"./request-BcXuuXiC.js";import{S as Be,A as Fe}from"./Sort-C4l355fM.js";import{C as Ve}from"./CreateAndEditUsers-Dtf0D2Ik.js";import{A as qe}from"./AdminSupportAgentTableAction-CgZRwmNf.js";import{D as Ge}from"./index-C3zqOI4w.js";import{S as le}from"./index-5u-uvn5B.js";import{g as Qe}from"./subscriptions-Dbjy7cDX.js";import{l as Je}from"./login-v1-BpcTMk8t.js";import{R as We,a as Ye}from"./SyncOutlined-CFNNNG5J.js";import{F as Ze}from"./FireTwoTone-CtAvDL6N.js";import"./CustomInput-B54BPh_e.js";import"./Steps-DqoGLFw9.js";import"./SyncOutlined-BXCvzby4.js";function q(){return q=Object.assign?Object.assign.bind():function(n){for(var a=1;a<arguments.length;a++){var c=arguments[a];for(var p in c)Object.prototype.hasOwnProperty.call(c,p)&&(n[p]=c[p])}return n},q.apply(this,arguments)}const Ke=(n,a)=>l.createElement(je,q({},n,{ref:a,icon:Ze})),Xe=l.forwardRef(Ke);function et({isvisible:n,setVisible:a,row_data:c}){const{rolesFormatter:p}=l.useContext(te),u=w(),r=()=>{a(!1)};function h(o={}){function x(){u(`/super-admin/user/${o==null?void 0:o._id}`,{state:{role:o==null?void 0:o.role}})}return{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("h1",{className:"font-semibold font-base cursor-pointer select-none hover:text-primary/70",onClick:x,children:[o==null?void 0:o.name," ",o==null?void 0:o.last_name]}),e.jsx(k,{children:p[o==null?void 0:o.role]})]}),description:e.jsxs("ul",{children:[e.jsxs("li",{className:"flex items-center gap-1",children:[e.jsx(be,{}),e.jsx("p",{children:o==null?void 0:o.email})]}),e.jsxs("li",{className:"flex items-center gap-1",children:[e.jsx(ye,{}),e.jsxs("p",{children:[o==null?void 0:o.contact_code," ",o==null?void 0:o.contact_number]})]})]})}}return e.jsx("div",{children:e.jsx(G,{open:n,onCancel:r,footer:null,centered:!0,width:"80vw",className:"device-configuration-modal my-6 lg:max-w-[50vw]",children:e.jsx("div",{className:"p-3",children:e.jsx(le,{progressDot:!0,current:10,direction:"vertical",items:Array.isArray(c)?c==null?void 0:c.map(h):[]})})})})}function ee({data:n}){const[a,c]=l.useState(!1);return e.jsxs("div",{children:[e.jsx(D,{shape:"circle",icon:e.jsx(Se,{}),onClick:()=>c(!0)}),e.jsx(et,{isvisible:a,setVisible:c,row_data:n==null?void 0:n.parents})]})}function tt({data:n}){var t,d,_,y;const[a,c]=l.useState(!1),[p,u]=l.useState(!1),[r,h]=l.useState(null),[o,x]=l.useState([]),N=()=>{c(!1)},j=l.useCallback(()=>{u(!0),Qe({id:n==null?void 0:n.subscription_id}).then(g=>{h(g)}).catch(g=>{console.error("Error fetching subscription details:",g)}).finally(()=>{u(!1)})},[n]),i=l.useCallback(()=>{Ne({customer_id:r==null?void 0:r.customer}).then(g=>{x(g||[])}).catch(g=>{console.error("Error fetching payment methods:",g)})},[r==null?void 0:r.customer]);return l.useEffect(()=>{a&&j()},[a,j]),l.useEffect(()=>{r&&i()},[r,i]),e.jsxs("div",{children:[e.jsx(D,{shape:"round",icon:e.jsx(ve,{}),onClick:()=>c(!0),children:"Subscription"}),e.jsxs(G,{open:a,onCancel:N,footer:null,centered:!0,width:"80vw",className:"device-configuration-modal my-6 lg:max-w-[50vw]",children:[!r&&p&&e.jsx(se,{className:"flex justify-center items-center h-64"}),!r&&!p&&e.jsx(F,{image:F.PRESENTED_IMAGE_SIMPLE}),r&&e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Subscription Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-y-4 gap-x-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[16px] text-gray-500",children:"Subscription Status"}),e.jsxs("div",{className:"text-[20px] text-green-600 font-medium capitalize flex items-center gap-2",style:{color:(r==null?void 0:r.status)==="active"?"green":(r==null?void 0:r.status)==="trialing"?"black":"red"},children:[r&&e.jsxs("span",{className:"relative flex size-3",children:[e.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full  opacity-75",style:{backgroundColor:(r==null?void 0:r.status)==="active"?"green":(r==null?void 0:r.status)==="trialing"?"black":"red"}}),e.jsx("span",{className:"relative inline-flex size-3 rounded-full ",style:{backgroundColor:(r==null?void 0:r.status)==="active"?"green":(r==null?void 0:r.status)==="trialing"?"black":"red"}})]}),(r==null?void 0:r.status)||"--"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[16px] text-gray-500",children:"Amount"}),e.jsxs("div",{className:"text-[20px] text-black font-medium",children:["$ ",((t=r==null?void 0:r.plan)==null?void 0:t.amount)/100," ",(_=(d=r==null?void 0:r.plan)==null?void 0:d.currency)==null?void 0:_.toUpperCase()]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[16px] text-gray-500",children:"Recurring Cycle"}),e.jsx("div",{className:"text-[20px] text-black font-medium capitalize",children:((y=r==null?void 0:r.plan)==null?void 0:y.interval)||"--"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[16px] text-gray-500",children:"Next Payment Date"}),e.jsx("div",{className:"text-[20px] text-black font-medium",children:r!=null&&r.current_period_end?new Date((r==null?void 0:r.current_period_end)*1e3).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"--"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-[16px] text-gray-500 mb-2",children:"Saved Cards"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[o.map(g=>{const v=g.card,M=g.isDefault;return e.jsxs("div",{className:`border rounded-xl p-4 flex justify-between items-center shadow-sm ${M?"border-blue-600 bg-blue-50":"border-gray-200"}`,children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[14px] text-gray-500",children:v.brand.toUpperCase()}),e.jsxs("div",{className:"text-[18px] font-medium",children:["**** **** **** ",v.last4]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Exp: ",v.exp_month,"/",v.exp_year]})]}),M&&e.jsx("div",{className:"text-blue-600 text-sm font-medium bg-blue-100 px-3 py-1 rounded-full",children:"Default"})]},g.id)}),o.length===0&&e.jsx("div",{className:"text-gray-500 text-sm italic",children:"No saved cards available."})]})]})]})]})]})]})}function st({isvisible:n,setVisible:a,row_data:c}){const{rolesFormatter:p}=l.useContext(te),[u,r]=l.useState(!0);w();const[h,o]=l.useState([]),x=()=>{a(!1)},N=l.useCallback(()=>{c!=null&&c._id&&(r(!0),Ce({userId:c==null?void 0:c._id}).then(i=>{o(i==null?void 0:i.data)}).catch(i=>{console.log(i)}).finally(()=>{r(!1)}))},[c==null?void 0:c._id]);l.useEffect(()=>{N()},[N]);function j(i={}){function t(d){r(!0),Je({id:d}).then(_=>{Z.success("Logout Seccessfully!"),N()}).catch(_=>{Z.error("Failed to Logout!"),console.log(_)}).finally(()=>{r(!1)})}return{title:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h1",{className:"font-semibold font-base cursor-pointer select-none hover:text-primary/70",children:i==null?void 0:i.deviceName}),e.jsx(k,{children:i==null?void 0:i.deviceType})]}),description:e.jsx("div",{children:e.jsxs("ul",{children:[e.jsxs("li",{className:"flex items-center gap-1",children:[e.jsx(Y,{}),e.jsxs("p",{children:[" ","Logout Status:"," ",i!=null&&i.loggedOut?e.jsx(k,{color:"red",children:"Logged Out"}):e.jsx(k,{color:"green",children:"Active"})]})]}),e.jsxs("li",{className:"flex items-center gap-1",children:[e.jsx(Ae,{}),e.jsxs("p",{children:["IP Adress: ",i==null?void 0:i.ipAddress]})]}),!(i!=null&&i.loggedOut)&&e.jsx("li",{className:"flex items-center gap-1 logout_pop",children:e.jsx(Ee,{title:"Logout!",description:"Are you sure to logout?",onConfirm:()=>t(i==null?void 0:i._id),okText:"Yes",cancelText:"No",className:"p-4 ",children:e.jsx(D,{className:"mt-4",icon:e.jsx(Y,{}),children:"Logout"})})})]})})}}return e.jsx("div",{children:e.jsx(G,{open:n,onCancel:x,footer:null,centered:!0,width:"80vw",className:"device-configuration-modal my-6 lg:max-w-[50vw] !max-h-[90vh]",children:e.jsxs("div",{className:"p-3",children:[e.jsx("h1",{className:"text-primary font-semibold text-2xl mb-4",children:" All Logins"}),e.jsx(se,{spinning:u,className:"w-full mx-auto py-16",children:e.jsxs("div",{className:"min-h-[300px] flex items-start justify-center h-full !max-h-[80vh] overflow-y-auto",children:[h.length==0&&e.jsx("div",{className:"w-full flex items-center mt-12 justify-center",children:e.jsx(F,{className:"mx-auto w-fit flex flex-col items-center justify-center"})}),(h==null?void 0:h.length)>0&&e.jsx(le,{current:1e4,direction:"vertical",progressDot:(i,{index:t})=>{const d=h[t],_=d!=null&&d.loggedOut?"red":"green";return e.jsx("span",{style:{width:10,height:10,borderRadius:"50%",display:"inline-block",backgroundColor:_}})},items:Array.isArray(h)?h.map(i=>({...j(i),className:i.loggedOut?"loggedout-step":"active-step"})):[]})]})})]})})})}function nt({data:n}){const[a,c]=l.useState(!1);return e.jsxs("div",{children:[e.jsx(D,{shape:"circle",icon:e.jsx(Me,{}),onClick:()=>c(!0)}),a&&e.jsx(st,{isvisible:a,setVisible:c,row_data:n})]})}function rt({row:n}){const[a,c]=l.useState(n==null?void 0:n.status),[p,u]=l.useState(!1),r=h=>{u(!0),re(n==null?void 0:n._id,{status:h}).then(o=>{var x;console.log(o),o&&c((x=o==null?void 0:o.user)==null?void 0:x.status)}).finally(()=>{u(!1)})};return l.useEffect(()=>{c(n==null?void 0:n.status)},[n]),e.jsx(ne,{theme:{token:{colorText:"#707EAE",colorPrimary:"#06A44F",colorLinkActive:"#8086AC",colorLinkHover:"#8086AC",colorLink:"#8086AC"}},children:e.jsx(Ue,{loading:p,onChange:r,handleBg:"#00000",className:"bg-slate-200",value:a})})}function lt({row:n}){const[a,c]=l.useState(n==null?void 0:n.status),[p,u]=l.useState(!1),r=h=>{u(!0),re(n==null?void 0:n._id,{status:h}).then(o=>{var x;console.log(o),o&&c((x=o==null?void 0:o.user)==null?void 0:x.status)}).finally(()=>{u(!1)})};return l.useEffect(()=>{c(n==null?void 0:n.status)},[n]),e.jsxs("div",{className:"flex items-center space-x-2 mr-0 ",children:[e.jsx("span",{className:`w-3 h-3 rounded-full relative -right-2 ${a==!0?"bg-[#1EB564]":"bg-red-500"}`}),e.jsx(ne,{theme:{token:{colorText:"#707EAE",colorPrimary:"#8086AC",colorLinkActive:"#8086AC",colorLinkHover:"#8086AC",colorLink:"#8086AC"}},children:e.jsx(Oe,{value:a,variant:"borderless",onChange:r,loading:p,optionSelectedColor:"#8086AC",dropdownMatchSelectWidth:!1,className:"w-fit !text-red-100",options:[{value:!1,label:e.jsx("span",{children:"Disable"})},{value:!0,label:e.jsx("span",{children:"Active"})}]})})]})}const ot=n=>{const[a,c]=l.useState(V.get("mainRole")),[p,u]=l.useState(void 0),{setUserDetil:r}=ke(),h=w(),o=(t,d)=>{r(t),h(`/super-admin/user/${n=="Users"?t.end_user_id+"-"+t._id:t._id}`,{state:{role:t.role}})},x={super_admin:{distributor:["name","address","contact_person","contact_number","office_count","seles_agent_count","nursing_home_count","monitoring_company_count","end_user_count","action"],office:["name","address","contact_person","contact_number","seles_agent_count","nursing_home_count","monitoring_company_count","end_user_count","action"],sales_agent:["name","address","contact_number","agent_id","nursing_home_count","monitoring_company_count","end_user_count","action"],nursing_home:["name","address","contact_person","contact_number","elderly_count","device_count","alert_count","assigned_nurse_count","action"],monitoring_station:["name","address","contact_number","action"],control_center:["name","address","contact_person","contact_number","elderly_count","device_count","action"],support_agent:["name","address","contact_number","action"],installer:["name","address","contact_number","elderly_count","action"],super_admin:["name","contact_number","action"],end_user:["name","address","contact_number","elderly_count","alert_count","device_count","action"],elderly:["name","age","email","contact_number","address","alert_count","device_count","action"],nurse:["name","contact_number","action"]}},N={distributor_id:"distributor",office_id:"office",sales_agent_id:"sales_agent",nursing_home_id:"nursing_home",monitoring_station_id:"monitoring_station",support_agent_id:"support_agent"};function j(t,d){h(`/super-admin/user/${d}`,{state:{role:N[t]}})}const i={name:{title:t=>{switch(t){case"office":return"Office";case"nurse":return"Nurse Name";case"distributor":return"Distributor Name";case"sales_agent":return"Sales Agent Name";case"nursing_home":return"Nursing Home";case"end_user":return"End User";case"monitoring_station":return"Monitoring Station";case"control_center":return"Control Center";case"support_agent":return"Support Agent";case"installer":return"Installer";case"elderly":return"User Name";default:return"Name"}},onCell:(t,d)=>({onClick:_=>{o(t)}}),render:t=>{const d=n==="Users"?"elderly":null;return e.jsx("button",{children:e.jsx(Le,{data:t,role:d})})}},address:{title:t=>{switch(t){case"elderly":return"Caregiver Address";default:return"Address"}},render:t=>e.jsx("button",{style:{width:"200px",textAlign:"left"},children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:n==="Users"?t.end_user_address:t.address})})},email:{title:t=>{switch(t){case"elderly":return"Caregiver Email";default:return"Email Address"}},render:t=>e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondar text-nowrapy",children:n==="Users"?t.end_user_email:t.email})},contact_number:{title:t=>{switch(t){case"elderly":return"Caregiver Number";default:return"Contact Number"}},render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:n==="Users"?`${t.end_user_contact_code?t.end_user_contact_code:""} ${t.end_user_contact_number}`:`${t.contact_code?t.contact_code:""} ${t.contact_number}`})})},contact_person:{title:"Contact Person",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.contact_person})})},date:{title:"Date of Sales",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.date})})},age:{title:"Age",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.age})})},parents:{title:"Ownership Structure",render:t=>e.jsx(ee,{data:t})},ownership_str:{title:"Ownership Structure",render:t=>{if(!t.hierarchy)return;const d={distributor_id:"Distributor",office_id:"Office",sales_agent_id:"Sales Agent",nursing_home_id:"Nursing Home",monitoring_station_id:"Monitoring Station"},_=[{id:"distributor_id",title:d.distributor_id,value:t.hierarchy.distributor_id||"N/A"},{id:"office_id",title:d.office_id,value:t.hierarchy.office_id||"N/A"},{id:"sales_agent_id",title:d.sales_agent_id,value:t.hierarchy.sales_agent_id||"N/A"},{id:"monitoring_station_id",title:d.monitoring_station_id,value:t.hierarchy.monitoring_station_id||"N/A"},{id:"nursing_home_id",title:d.nursing_home_id,value:t.hierarchy.nursing_home_id||"N/A"}].filter(y=>y.value!=="N/A");return e.jsx("div",{className:"ownership-str",children:_.map((y,g)=>e.jsxs("button",{onClick:()=>j(y.id,y.value),className:"ownership-button",children:[e.jsxs("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary hover:text-text-primary",children:[y.title," "]}),g<_.length-1&&" / "]},y.id))})}},external_id:{title:"External ID",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.external_id})})},products:{title:"Products",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.products})})},products_price:{title:"Products Price",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.products_price})})},addons:{title:"Addons",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.addons})})},addons_price:{title:"Addons Price",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.addon_price})})},total_price:{title:"Total Price",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.total})})},avg_sales:{title:"Average Sales",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.aleravg_salest_count})})},alert_count:{title:"Active Alerts",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.unresolved_alarm_count||0})})},subscription_plan:{title:"Subscription Plan",render:t=>e.jsx("button",{children:e.jsxs("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary text-nowrap",children:[e.jsx(Xe,{})," AI Monitoring"]})})},last_login:{title:"Last Login",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary text-nowrap",children:"12-05-2025; 10: 23 PM"})})},subscription_ex_date:{title:"Subscription Expire Date",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary text-nowrap",children:"1 July, 2026"})})},subscription_status:{title:"Subscription Status",render:t=>{const d=crypto.getRandomValues(new Uint8Array(1))[0]/255<.5;return e.jsx("button",{children:e.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary",children:d?e.jsx(k,{icon:e.jsx(We,{spin:!0}),color:"success",className:"font-semibold",children:"Active"}):e.jsx(k,{icon:e.jsx(Ye,{}),className:"font-semibold",children:"Canceled"})})})}},device_count:{title:"Devices",render:t=>e.jsx("button",{children:e.jsxs("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary flex gap-3",children:[e.jsx(K,{title:"Online Devices",children:e.jsxs("div",{className:"flex items-center gap-1 border px-2 py-1 rounded-2xl hover:bg-slate-100",children:[e.jsx("div",{className:"size-2 bg-success rounded-full "})," ",e.jsx("span",{className:"leading-3 font-semibold",children:t==null?void 0:t.online_device_count})]})}),e.jsx(K,{title:"Offline Devices",children:e.jsxs("div",{className:"flex items-center gap-1 border px-2 py-1 rounded-2xl hover:bg-slate-100",children:[e.jsx("div",{className:"size-2 bg-Critical rounded-full "})," ",e.jsxs("span",{className:"leading-3 font-semibold",children:[" ",t==null?void 0:t.offline_device_count]})]})})]})})},sales_agent_count:{title:"Sales Agents",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.sales_agent_count})})},end_user_count:{title:"End Users",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.end_user_count})})},nursing_home_count:{title:"Nursing Homes",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.nursing_home_count})})},monitoring_company_count:{title:"Monitoring Stations",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.monitoring_station_count})})},office_count:{title:"Offices",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.office_count})})},elderly_count:{title:"Elderly",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.elderly_count})})},assigned_nurse_count:{title:"Assigned Nurse",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.nurse_count})})},office_name:{title:"Office Name",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.office_name})})},distributor_name:{title:"Distributor Name",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.distributor_name})})},sales_agent_name:{title:"Sales Agent Name",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.sales_agent_name})})},installer:{title:"Installer Name",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.installer_name})})},agent_id:{title:"Agent ID",render:t=>e.jsx("button",{children:e.jsx("span",{className:" text-[14px] xl:text-base  font-normal text-text-secondary",children:t.agent_id})})},status:{title:"Status",render:t=>(t==null?void 0:t.role)=="sales_agent"?e.jsx(rt,{row:t}):e.jsx(lt,{row:t})},action:{title:"",key:"id",fixed:"right",width:150,render:t=>{var d;return e.jsxs("div",{className:"flex items-center gap-2",children:[(n==null?void 0:n.includes("End User"))&&e.jsx("button",{disabled:!(t!=null&&t.subscription_id),className:"disabled:opacity-20",children:e.jsx(tt,{data:t})}),!(n!=null&&n.includes("Monitoring Station"))&&!(n!=null&&n.includes("Distributors"))&&e.jsx("button",{disabled:((d=t==null?void 0:t.parents)==null?void 0:d.length)===0,className:"disabled:opacity-20",children:e.jsx(ee,{data:t})}),a=="super_admin"&&e.jsx(nt,{data:t}),e.jsx(qe,{data:n=="Users"?{...t,role:"user"}:t})]})}}};return l.useEffect(()=>{var t,d,_,y,g,v,M,I,L,T,U,O;if(n=="Super Admins"){const f=(((t=x[a])==null?void 0:t.super_admin)||[]).map(m=>{const s=i[m];return{...s,title:s&&typeof s.title=="function"?s.title("super_admin"):s==null?void 0:s.title}});u(f)}else if(n=="Support Agents"){const f=(((d=x[a])==null?void 0:d.support_agent)||[]).map(m=>{const s=i[m];return{...s,title:s&&typeof s.title=="function"?s.title("support_agent"):s==null?void 0:s.title}});u(f)}else if(n=="Distributors"){const f=(((_=x[a])==null?void 0:_.distributor)||[]).map(m=>{const s=i[m];return{...s,title:s&&typeof s.title=="function"?s.title("distributor"):s==null?void 0:s.title}});u(f)}else if(n=="Offices"){const f=(((y=x[a])==null?void 0:y.office)||[]).map(m=>{const s=i[m];return{...s,title:s&&typeof s.title=="function"?s.title("office"):s==null?void 0:s.title}});u(f)}else if(n=="Nursing Homes"){const f=(((g=x[a])==null?void 0:g.nursing_home)||[]).map(m=>{const s=i[m];return{...s,title:s&&typeof s.title=="function"?s.title("nursing_home"):s==null?void 0:s.title}});u(f)}else if(n=="Sales Agents"){const f=(((v=x[a])==null?void 0:v.sales_agent)||[]).map(m=>{const s=i[m];return{...s,title:s&&typeof s.title=="function"?s.title("sales_agent"):s==null?void 0:s.title}});u(f)}else if(n=="End Users"){const f=(((M=x[a])==null?void 0:M.end_user)||[]).map(m=>{const s=i[m];return{...s,title:s&&typeof s.title=="function"?s.title("end_user"):s==null?void 0:s.title}});u(f)}else if(n=="Installers"){const f=(((I=x[a])==null?void 0:I.installer)||[]).map(m=>{const s=i[m];return{...s,title:s&&typeof s.title=="function"?s.title("installer"):s==null?void 0:s.title}});u(f)}else if(n=="Monitoring Stations"){const f=(((L=x[a])==null?void 0:L.monitoring_station)||[]).map(m=>{const s=i[m];return{...s,title:s&&typeof s.title=="function"?s.title("monitoring_station"):s==null?void 0:s.title}});u(f)}else if(n=="Control Centers"){const f=(((T=x[a])==null?void 0:T.control_center)||[]).map(m=>{const s=i[m];return{...s,title:s&&typeof s.title=="function"?s.title("control_center"):s==null?void 0:s.title}});u(f)}else if(n=="Nurses"){console.log(n);const f=(((U=x[a])==null?void 0:U.nurse)||[]).map(m=>{const s=i[m];return{...s,title:s&&typeof s.title=="function"?s.title("nurse"):s==null?void 0:s.title}});u(f)}else if(n=="Users"){const f=(((O=x[a])==null?void 0:O.elderly)||[]).map(m=>{const s=i[m];return{...s,title:s&&typeof s.title=="function"?s.title("elderly"):s==null?void 0:s.title}});u(f)}},[n]),p},it=n=>{const a=l.useRef(null),[c,p]=l.useState(null),[u,r]=l.useState(!1),[h,o]=l.useState(null),x=l.useCallback(async(N={})=>{r(!0),o(null),a.current&&a.current.cancel("Previous request canceled!"),a.current=X.CancelToken.source();try{const j=await n({...N,cancelToken:a.current.token});p(j)}catch(j){X.isCancel(j)?console.log("Request canceled:",j.message):(console.error("Fetch error:",j),o(j))}finally{r(!1)}},[n]);return l.useEffect(()=>()=>{a.current&&a.current.cancel("Component unmounted, request canceled!")},[]),{response:c,loading:u,error:h,makeRequest:x}},Nt=()=>{const{response:n,loading:a,makeRequest:c}=it(ze);Pe();const p=Re(),u=w(),[r,h]=l.useState(""),[o,x]=l.useState(!1),[N,j]=l.useState({}),[i,t]=l.useState(""),[d,_]=l.useState("Monitoring Stations"),[y,g]=l.useState(V.get("mainRole")),[v,M]=l.useState([]),[I,L]=l.useState(!1),[T,U]=l.useState(!0),[O]=l.useState([{bo:!0,warring:!1,text:"Monitoring Stations"},{bo:!0,warring:!1,text:"Distributors"},{bo:!0,warring:!1,text:"Offices"},{bo:!0,warring:!1,text:"Sales Agents"},{bo:!0,warring:!1,text:"Nursing Homes"},{bo:!0,warring:!1,text:"Nurses"},{bo:!0,warring:!1,text:"Control Centers"},{bo:!0,warring:!1,text:"Support Agents"},{bo:!0,warring:!1,text:"Installers"},{bo:!0,warring:!1,text:"End Users"},{bo:!0,warring:!1,text:"Users"}]),[S,f]=l.useState(V.get("user")),[m,s]=l.useState(""),[oe,Q]=l.useState(!1),[P,ie]=l.useState("Time"),[H,$]=l.useState({}),[E,z]=l.useState({}),[at,ae]=l.useState([]),[ce,de]=l.useState(0),[ue,xe]=l.useState([]),me={Distributors:"Distributor","Nursing Homes":"Nursing Home","Sales Agents":"Sales Agent","Support Agents":"Support Agent","Super Admins":"Super Admin",Users:"User",Installers:"Installer","Monitoring Stations":"Monitoring Station","Control Centers":"Control Center",Offices:"Office","End Users":"End User",Nurses:"Nurse"},he={Distributors:"distributor","Nursing Homes":"nursing_home","Sales Agents":"sales_agent","Support Agents":"supports_agent","Monitoring Stations":"monitoring_agency","Control Centers":"monitoring_station",Installers:"installer","End Users":"end_user",Offices:"office","Super Admins":"super_admin",Users:"elderly",Nurses:"nurse"},fe=["Time","Name"],B=ot(r);l.useEffect(()=>{B&&xe(B)},[B,r]),l.useEffect(()=>{const C=new URLSearchParams(p.search).get("tab");O.map(_e=>_e.text).includes(C)?h(C):h("Monitoring Stations"),u(`/super-admin/users?tab=${C}`)},[]);const pe=()=>{Q(!0)},ge=b=>{$({page:1}),h(b.name)},R=l.useCallback(async()=>{ae([]);let b={...H,...E};const C=me[r];if(_(C),b.role=he[r],t(b.role),u(`/super-admin/users?tab=${r}`),b.role==="elderly")L(!0),delete b.role,Ie({...b}).then(A=>{M(A.data),de(A==null?void 0:A.total)}).catch(A=>{console.log(A)}).finally(()=>{L(!1)});else{U(!0);try{await c({...b})}catch(A){console.log(A)}}},[E,r,H]);l.useEffect(()=>{n&&!a&&U(!1)},[n]),l.useEffect(()=>{R()},[R]);const J=l.useRef(!1);l.useEffect(()=>{J.current?P&&E.orderType!==P&&(delete E.sort_by_created_at,delete E.sort_by_name,z({...E,...P==="Name"?{sort_by_name:-1}:{sort_by_created_at:-1}}),$({...H,page:1})):J.current=!0},[P]);const W=l.useCallback(Te(b=>{z(C=>({...C,search:b.trim()})),$(C=>({...C,page:1}))},1e3),[]);return l.useEffect(()=>()=>{W.cancel()},[]),e.jsxs("div",{className:"",children:[e.jsx("div",{className:"pt-[20px] pb-[10px] flex",children:e.jsx(Ge,{menus:O,activeTab:r,setActiveTab:!1,handleChange:ge})}),e.jsxs("div",{className:" bg-white rounded-2xl overflow-hidden",children:[e.jsxs("div",{className:" px-[22px] py-6 flex items-start flex-col lg:flex-row justify-between gap-2",children:[e.jsx("div",{className:" flex items-center justify-between w-full",children:e.jsx("h2",{className:" text-2xl font-bold text-text-primary",children:r})}),e.jsxs("div",{className:" flex items-center justify-end gap-5 w-full",children:[e.jsx(He,{search:m,setSearch:b=>{s(b),W(b)},placeholder:`Search ${d}`}),!["User"].includes(d)&&e.jsx(Be,{query:E,setQuery:z,selected:P,setSelected:ie,data:fe}),e.jsxs($e,{onClick:()=>pe(),className:" hidden lg:flex ",style:{display:["User"].includes(d)?"none":"flex"},children:[e.jsx("div",{className:"mr-1",dangerouslySetInnerHTML:{__html:we.sanitize(`<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 19 19" fill="none">
                <path d="M10.0941 5.54102C10.0941 5.2131 9.82824 4.94727 9.50033 4.94727C9.17241 4.94727 8.90658 5.2131 8.90658 5.54102V8.9056H5.54199C5.21407 8.9056 4.94824 9.17143 4.94824 9.49935C4.94824 9.82727 5.21407 10.0931 5.54199 10.0931H8.90658V13.4577C8.90658 13.7856 9.17241 14.0514 9.50033 14.0514C9.82824 14.0514 10.0941 13.7856 10.0941 13.4577V10.0931H13.4587C13.7866 10.0931 14.0524 9.82727 14.0524 9.49935C14.0524 9.17143 13.7866 8.9056 13.4587 8.9056H10.0941V5.54102Z" fill="white"/>
                </svg>`)}}),"Add New ",d]})]})]}),e.jsx("div",{className:" grid grid-cols-1",children:e.jsx(De.Provider,{value:{getlist:R,query:E,total:r=="Users"?ce:(n==null?void 0:n.total)||[],page:H,SetPage:$,role:i},children:e.jsx(Fe,{loading:r=="Users"?I:T,tableData:r=="Users"?v:n==null?void 0:n.data,getlist:R,columns:ue})})})]}),e.jsx("div",{className:"mt-[38px] ",children:e.jsx("div",{className:"font-semibold"})}),e.jsx(Ve,{changeParams:N,item:{},getlist:R,role:i,modalOPen:oe,setModalOpen:Q})]})};export{Nt as default};
