import{r as s,bO as b,bN as C,jx as w,j as e,J as H,jz as M,kB as _}from"./index-CR4fhODd.js";import B from"./LiveRateChart-3xwLo1Bm.js";function k(){var h,v,j;const{elderlyDetails:i,sleepData:a}=s.useContext(b),{deviceData:o}=s.useContext(C),n=i!=null&&i.deviceId?i.deviceId.split(",").map(t=>t.trim()):[],[g,f]=s.useState({time:[],heartRate:[],breathRate:[]}),[x,l]=s.useState(null),d=s.useRef(null),u=s.useRef(Date.now()),N=s.useCallback(t=>{if(d.current===t)return;d.current=t,u.current=Date.now();const r=w(t);l(r);const p=new Date().toLocaleTimeString();f(R=>{let m=[...R.time],c=[...R.heartRate];if(c.length===0){const y=Math.max(0,r.heartRateValue+(Math.random()<.5,0));m.push(p),c.push(y)}return m.push(p),c.push(r.heartRateValue),{time:m.slice(-30),heartRate:c.slice(-30)}})},[]);return s.useEffect(()=>{const t=setInterval(()=>{Date.now()-u.current>5e3&&(f({time:[],heartRate:[]}),l(null),d.current=null)},500);return()=>clearInterval(t)},[]),s.useEffect(()=>{if(!(n!=null&&n.length)){l(null);return}for(const t of n){if(!o[t])continue;const{heartBreath:r}=o[t];if(r){N(r);return}}l(null)},[o]),e.jsxs("div",{className:"w-full bg-white rounded-2xl p-6 flex flex-col gap-6 h-auto",children:[e.jsxs("div",{className:"text-2xl font-bold text-primary flex items-center gap-2",children:["Current Heart Activity"," ",e.jsx(H,{title:"This feature functions only if the user is in the monitoring bed.",className:"cursor-pointer",children:e.jsx(M,{size:"18px"})})]}),e.jsx("div",{id:"LiveRate",className:"flex flex-col gap-1 pl-3 mb-2",children:e.jsxs("div",{className:"text-4xl font-bold flex items-center gap-2",style:{color:"#D76C82"},children:[(x==null?void 0:x.heartRateValue)??"--"," ",e.jsx("span",{className:"text-secondary/40",children:"BPM"}),e.jsx(_,{color:"#D76C82",size:24})]})}),e.jsx(B,{data:g,color:"#D76C82",type:"heartRate"}),e.jsx("div",{id:"footer",children:e.jsxs("div",{className:"flex justify-evenly items-center",children:[e.jsxs("div",{id:"avgRate",className:"flex flex-col items-center justify-center gap-0",children:[e.jsx("div",{className:"text-3xl text-primary font-bold",children:((h=a==null?void 0:a.heart_rate_vo)==null?void 0:h.avg)??"--"}),e.jsx("div",{className:"text-sm text-gray-500 font-semibold",children:"Average"})]}),e.jsxs("div",{id:"minRate",className:"flex flex-col items-center justify-center gap-0",children:[e.jsxs("div",{className:"text-3xl text-primary font-bold",children:[" ",((v=a==null?void 0:a.heart_rate_vo)==null?void 0:v.min)??"--"]}),e.jsx("div",{className:"text-sm text-gray-500 font-semibold",children:"Minimum"})]}),e.jsxs("div",{id:"maxRate",className:"flex flex-col items-center justify-center gap-0",children:[e.jsxs("div",{className:"text-3xl text-primary font-bold",children:[" ",((j=a==null?void 0:a.heart_rate_vo)==null?void 0:j.max)??"--"]}),e.jsx("div",{className:"text-sm text-gray-500 font-semibold",children:"Maximum"})]})]})})]})}export{k as default};
