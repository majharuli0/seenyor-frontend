import{r as O,j as k,t as T,E as N,i as V,G as H}from"./index-CR4fhODd.js";function Y({data:c,dataType:x,color:S,chartType:D="Day",toDate:v,fromDate:_,xUnit:p="date",hourLimit:w=12,numberLimit:z=100,dataUnit:B="",chartFor:g=""}){const $=O.useMemo(()=>{if(!(c!=null&&c.length))return null;function I(e){const a=Array.from({length:12},(r,s)=>{const d=60+s*60,f=Math.floor(d/60),b=d%60;return b===0?`${f} hr`:`${f} hr ${b} min`}),t=new Array(a.length).fill(0);e==null||e.forEach(r=>{const s=Math.floor((r.sleep_total_time-60)/60);s>=0&&s<t.length&&t[s]++});const o=t.reduce((r,s)=>r+s,0),l=t.map(r=>o>0?(r/o*100).toFixed(0):"0");return{xaxis:a,data:l}}function M(e){const a=Array.from({length:10},(r,s)=>`${0+s*10}-${0+(s+1)*10}`),t=new Array(a.length).fill(0);e==null||e.forEach(r=>{const s=Math.floor(g!=="deepSleepPercentageDistribution"?(r==null?void 0:r.sleep_efficiency)/10:(r==null?void 0:r.sleep_quality)/10);s>=0&&s<t.length&&t[s]++});const o=e.length,l=t.map(r=>o>0?(r/o*100).toFixed(0):"0");return H.set(g,{xaxis:a,data:l}),{xaxis:a,data:l}}function E(e){const n=Array.from({length:6},(l,r)=>`${r*5}-${(r+1)*5}`),a=new Array(n.length).fill(0);e==null||e.forEach(l=>{const r=parseFloat(l.ahi),s=Math.floor(r/5);s>=0&&s<a.length&&a[s]++});const t=e.length,o=a.map(l=>t>0?(l/t*100).toFixed(0):"0");return{xaxis:n,data:o}}function C(e){const n=[...Array.from({length:12},(l,r)=>`${r*10}-${(r+1)*10} min`),"120min+"],a=new Array(n.length).fill(0);e==null||e.forEach(l=>{const r=l.totalFallAsleepDuration;let s=Math.floor(r/10);r>=120&&(s=a.length-1),s>=0&&s<a.length&&a[s]++});const t=e.length,o=a.map(l=>t>0?(l/t*100).toFixed(0):"0");return{xaxis:n,data:o}}function R(e){const i={xaxis:Array.from({length:31},(r,s)=>s+6).map(r=>r.toString()),data:Array(31).fill(0)};let n=Array(31).fill(0);e.forEach(r=>{const s=r.data_list.filter(f=>f!=="-1"&&f!=="0").map(Number);let d=Array(31).fill(0);s.forEach(f=>{if(f>=6&&f<=36){const b=f-6;d[b]++}}),d.forEach((f,b)=>{n[b]+=f})});const a=n.map((r,s)=>r>0?s:null).filter(r=>r!==null);if(a.length===0)return i;const t=Math.max(a[0]-1,0),o=Math.min(a[a.length-1]+1,30),l=n.slice(t,o+1).reduce((r,s)=>r+s,0);return i.data=n.map((r,s)=>s>=t&&s<=o&&l>0?(r/l*100).toFixed(2):"0.00"),i}const y=["45-50","50-55","55-60","60-65","65-70","70-75","75-80","80-85","85-90","90-95","95-100","100-105","105-110","110-115","115-120"],j=e=>{const u=new Array(y.length).fill(0);e==null||e.forEach(a=>{a.data_list.forEach(t=>{if(t>0)for(let o=0;o<y.length;o++){const[l,r]=y[o].split("-").map(Number);if(t>=l&&t<r){u[o]+=1;break}}})});const i=e==null?void 0:e.reduce((a,t)=>a+t.data_list.filter(o=>o>0).length,0),n=u.map(a=>(a/i*100).toFixed(0));return{xaxis:y,data:n}},h=(()=>{if(p==="number"){if(g==="apneaIndexDistribution"){const{xaxis:e,data:u}=E(c);return e.map((i,n)=>({number:i,value:u[n]}))}else if(g==="heartRateDistribution"){const{xaxis:e,data:u}=j(c);return e.map((i,n)=>({number:i,value:u[n]}))}else if(g==="breathRateDistribution"){const{xaxis:e,data:u}=R(c);return e.map((i,n)=>({number:i,value:u[n]}))}}if(p==="hour")if(c&&c.length>0&&g==="durationDistribution"){const{xaxis:e,data:u}=I(c);return e.map((i,n)=>({hour:i,percentage:parseInt(i,10),value:u[n]}))}else if(c&&c.length>0&&g==="fallAsleepDurationDistribution"){const{xaxis:e,data:u}=C(c);return e.map((i,n)=>({hour:i,percentage:parseInt(i,10),value:u[n]}))}else return Array.from({length:w},(e,u)=>({hour:u,value:0,percentage:0}));else if(p==="percentage")if(g==="efficiencyDistribution"||g==="deepSleepPercentageDistribution"){const{xaxis:e,data:u}=M(c);return e.map((i,n)=>({percentage:i,value:u[n]}))}else{const e=Array.from({length:11},(i,n)=>n*10),u=new Map(c.map(i=>[Math.floor(i.sleep_efficiency/10)*10,{value:i.sleep_efficiency,date:i.date}]));return e.map(i=>{var n,a;return{percentage:i,value:((n=u.get(i))==null?void 0:n.value)||0,date:((a=u.get(i))==null?void 0:a.date)||null}})}else{const e=(t,o)=>{var l,r,s,d;switch(o){case"roomInOut":return((l=t==null?void 0:t.user_activity)==null?void 0:l.entry_room_count)||"--";case"walkingStepsStatistix":return((r=t==null?void 0:t.user_activity)==null?void 0:r.step_number)||"--";case"walkingSpeedStatistic":return((s=t==null?void 0:t.user_activity)==null?void 0:s.speed)||"--";case"sleedDurationStatistic":return t.sleep_total_time||0;case"deepSleepPercentageStatistic":return t.sleep_quality||"--";case"numberOfBedExitTime":return t.leave_bed_count||"--";case"bedExitDuration":const f=(d=t.sleep_index_common_list)==null?void 0:d.find(b=>b.status==="3"||b.status===3);return f!=null&&f.value?parseInt(f.value):0;default:return t.ratio||t.bed_exit_duration||t.value||t.sleep_time||t.ahi||t.anomalyHeartRate||t.sleep_efficiency||t.totalFallAsleepDuration||"--"}},u=(t,o)=>t!=null&&t.date?t.date.split("T")[0]:t!=null&&t.datestr?o==="roomInOut"||o==="walkingStepsStatistix"||o==="walkingSpeedStatistic"?V(t.datestr).subtract(1,"day").format("YYYY-MM-DD"):t.datestr:null,n=((t,o)=>{const l=[],r=new Date(t);r.setUTCHours(0,0,0,0);const s=new Date(o);for(s.setUTCHours(0,0,0,0);r<=s;)l.push(r.toISOString().split("T")[0]),r.setUTCDate(r.getUTCDate()+1);return l})(_,v),a=new Map;return c==null||c.forEach(t=>{const o=u(t,g),l=e(t,g);o&&l!==0&&l!=="--"?a.set(o,l):o&&!a.has(o)&&a.set(o,0)}),n.map(t=>({date:t,value:a.get(t)||0}))}})(),A=(e,u="axis")=>{if(p==="percentage"||x==="percentage")return`${e}%`;if(x==="duration"){const i=Math.floor(e/60),n=e%60;return i>0?`${i}h ${n}m`:`${n}m`}return e},m=e=>{if(p==="number")return e==null?void 0:e.toString();if(p==="hour")return`${e}`;if(p==="percentage")return`${e}%`;if(D==="Week"){const i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],n=new Date(e);return i[n.getDay()]}return new Date(e).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit"}).replace("/","-")};return{xAxis:{type:"category",axisLabel:{fontSize:14},data:h.map(e=>m(p==="hour"?e.hour:p==="percentage"?e.percentage:p==="number"?e.number:e.date))},grid:{top:"5%",left:"8%",bottom:"15%",right:"2%"},yAxis:{type:"value",axisLabel:{fontSize:14,formatter:A},max:p==="percentage"||x==="percentage"?100:void 0},series:[{data:h.map(e=>e.value),type:"bar",barMaxWidth:20,itemStyle:{color:S||"#000",borderRadius:[50,50,0,0]}}],tooltip:{trigger:"axis",formatter:e=>{if(p==="number")if(g!=="apneaIndexDistribution"){const n=h[e[0].dataIndex];return`<div style="margin-top: 4px">
              <span >${n.value}%</span>
              <br>
              <span style="font-weight: bold">${n.number} BPM</span>
              </div>`}else{const n=h[e[0].dataIndex];return`<div style="margin-top: 4px">
              <span style="font-weight: bold">${n.value}%</span>
              <br>
              <span style="font-weight: normal">${n.number}</span>
              </div>`}else if(p==="hour"){const n=h[e[0].dataIndex];return`<div style="margin-top: 4px">
                    ${n.value?`<span>${n.value}%</span>`:"--"}
                    <br>
                    <span style="font-weight: bold">${n.hour}</span>
                    </div>`}else if(p==="percentage"){const n=h[e[0].dataIndex];if(n.date){const a=new Date(n.date).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"-");return`<div style="font-weight: bold">${n.value}%</div>
                     <div style="margin-top: 4px">${a}</div>`}return`<div style="font-weight: bold"> ${n.value}% <br/> <span style="font-weight: normal">${n.percentage}%</span></div>`}const u=h[e[0].dataIndex].date;return`<div style="font-weight: bold">${new Date(u).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"-")}</div>
                  <div style="margin-top: 4px">${A(e[0].value)}${B}</div>`}}}},[c,x,S,D,_,v,p,w,z]);return!(c!=null&&c.length)||!$?k.jsxs("div",{className:"w-full h-full flex items-center justify-center",children:[" ",k.jsx(T,{description:"No data available to show"})]}):k.jsx(N,{option:$,style:{height:"350px"}})}export{Y as default};
