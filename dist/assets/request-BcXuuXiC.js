import{Q as p,a6 as d,hR as m,z as f,j as b,a5 as j}from"./index-CR4fhODd.js";const O={set(e,s){sessionStorage&&e!=null&&s!=null&&sessionStorage.setItem(e,s)},get(e){return!sessionStorage||e==null?null:sessionStorage.getItem(e)},setJSON(e,s){s!=null&&this.set(e,JSON.stringify(s))},getJSON(e){const s=this.get(e);if(s!=null)return JSON.parse(s)},remove(e){sessionStorage.removeItem(e)}},u={session:O};function h(e){let s="";for(const r of Object.keys(e)){const t=e[r];var o=encodeURIComponent(r)+"=";if(t!==null&&t!==""&&typeof t<"u")if(typeof t=="object"){for(const n of Object.keys(t))if(t[n]!==null&&t[n]!==""&&typeof t[n]<"u"){let i=r+"["+n+"]";var a=encodeURIComponent(i)+"=";s+=a+encodeURIComponent(t[n])+"&"}}else s+=o+encodeURIComponent(t)+"&"}return s}function y(e){return Object.keys(e).length==0}p.defaults.headers["Content-Type"]="application/json;charset=utf-8";const c=p.create({baseURL:void 0,timeout:1e4});c.interceptors.request.use(e=>{const s=(e.headers||{}).isToken===!1,o=(e.headers||{}).repeatSubmit===!1;if(d()&&!s&&!e.url.includes("screen")&&(e.headers.Authorization="Bearer "+d()),e.method==="get"&&e.params){let a=e.url+"?"+h(e.params);a=a.slice(0,-1),e.params={},e.url=a}if(!o&&(e.method==="post"||e.method==="put")){const a={url:e.url,data:typeof e.data=="object"?JSON.stringify(e.data):e.data,time:new Date().getTime()},r=u.session.getJSON("sessionObj");if(r==null||r==="")u.session.setJSON("sessionObj",a);else{const t=r.url,n=r.data,i=r.time;n===a.data&&a.time-i<1e3&&t===a.url?console.warn(`[${t}]: `+"Data is being processed, please do not submit again"):u.session.setJSON("sessionObj",a)}}return e},e=>Promise.reject(e));c.interceptors.response.use(e=>{if(e.data.status===440&&e.data.forceLoggedOut===!0)return m(),Promise.reject("Session expired. Please log in again.");const s=e.data.code||"00000";return e.data.msg,e.request.responseType==="blob"||e.request.responseType==="arraybuffer"?e.data:s===401?Promise.reject("Invalid session or session has expired, please re-login."):e.data},e=>{var o,a,r,t,n,i;if(((a=(o=e.response)==null?void 0:o.data)==null?void 0:a.status)===440&&((t=(r=e.response)==null?void 0:r.data)==null?void 0:t.forceLoggedOut)===!0)return m(),Promise.reject(e);let s=(i=(n=e.response)==null?void 0:n.data)==null?void 0:i.msg;return f.custom(l=>b.jsx(j,{t:l,text:s,title:"Error"})),Promise.reject(e)});export{y as i,c as s};
