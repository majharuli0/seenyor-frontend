import{r as l,S as P,u as $,aL as _,j as t,jr as W,js as Y,cX as U,cY as V,cK as N,cM as S,jt as K,bu as Q,cZ as X,bO as G,aH as J,i as Z,B as q,C as v,bt as w,g as ee,$ as te,aO as ae,ch as le,aU as se}from"./index-CR4fhODd.js";function ne(n){const{rolesFormatter:f}=l.useContext(P),c=$(),u=e=>{window.scrollTo(0,0),c(`/supporter/elderlies/elderly-profile/${e.elderly_id}?tab=overview`)},d={allActivityTableData:["alertName","incidentTime","action2"],activeAlertsTableData:["alertName","alertType","elderlyName","roomName","incidentTime","alertLife","address","viewElderly"],recentlyClosedAlertsTableData:["alertName","incidentTime","alertLifetime","alertStatus","closedAt","closedBy","largeText","action2"],eventsTableData:["eventName","elderlyName","eventTime","eventTimeline","hospital","expandColumn","largeText","disabilityType","action"]},i={alertName:{title:"Title",render:e=>t.jsx(X,{data:e})},alertType:{title:"Type",render:e=>t.jsx("span",{children:Q(e)})},elderlyName:{title:"User Name",dataIndex:"elderly_name",render:e=>t.jsx("span",{children:e})},roomName:{title:"Room Name",dataIndex:"room_name",render:e=>t.jsx("span",{children:e})},incidentTime:{title:"Occurrence Time",dataIndex:"created_at",render:e=>t.jsx("span",{className:"text-nowrap",children:N(e)})},alertLifetime:{title:"Resolution Time",render:e=>e!=null&&e.closed_at?t.jsx("span",{className:"text-nowrap",children:K(e==null?void 0:e.created_at,e==null?void 0:e.closed_at)}):t.jsx(S,{date:e==null?void 0:e.created_at})},alertLife:{title:"Duration",dataIndex:"created_at",render:e=>t.jsx("span",{className:"text-nowrap",children:t.jsx(S,{date:e})})},alertStatus:{title:"Resolution Status",render:e=>e!=null&&e.closed_at?t.jsx("span",{className:"text-nowrap",children:e!=null&&e.status?"True Alert":"False Alert"}):t.jsx(t.Fragment,{children:"N/A"})},address:{title:"Address",width:"230px",render:e=>t.jsx("span",{className:"!w-[230px] text-nowrap",children:e.address})},closedAt:{title:"Closed At",render:e=>e!=null&&e.closed_at?t.jsx("span",{className:"text-nowrap",children:N(e==null?void 0:e.closed_at)}):t.jsx(t.Fragment,{children:"N/A"})},closedBy:{title:"Closed By",render:e=>e!=null&&e.closed_at?t.jsxs("span",{className:"text-nowrap",children:[e.closed_by," (",f[e.closed_by_role]," )"]}):t.jsx(t.Fragment,{children:"N/A"})},eventName:{title:"Event Name",dataIndex:"eventName",render:e=>t.jsx("span",{children:e})},eventTime:{title:"Event Time",dataIndex:"time",render:e=>t.jsx("span",{className:"text-nowrap",children:e})},eventTimeline:{title:"Event Timeline",dataIndex:"alertLifetime",render:e=>t.jsx("span",{className:"text-nowrap",children:e})},disabilityType:{title:"Disability Type",dataIndex:"disabilityType",render:e=>t.jsx("span",{className:"text-nowrap",children:e})},hospital:{title:"Hospital",dataIndex:"hospital",render:e=>t.jsx("span",{className:"text-nowrap",children:e.name.length>20?`${e.name.substring(0,20)}...`:e.name})},largeText:{title:()=>{switch(n){case"events":return"Additional Info";case"recentlyClosedAlert":return"Comments";case"allActivity":return"Comments";default:return""}},render:e=>e!=null&&e.closed_at?t.jsx(V,{data:n==="recentlyClosedAlert"?e==null?void 0:e.comment:n==="events"?e==null?void 0:e.additionalInfo:"",title:n==="recentlyClosedAlert"||n==="allActivity"?"Comment":n==="events"?"Additional Info":""}):"N/A"},expandColumn:_.EXPAND_COLUMN,viewElderly:{render:e=>t.jsxs("span",{onClick:()=>u(e),className:"flex items-center transition-all duration-300 justify-center gap-2 text-sm font-medium text-text-primary hover:text-primary cursor-pointer p-2 rounded-md  text-center hover:bg-slate-100",children:["View ",t.jsx(U,{})]})},action:{title:"Action",render:e=>t.jsx(Y,{row:e})},action2:{align:"right",render:e=>t.jsx(W,{row:e,onlyFall:!0})}},[m,r]=l.useState(void 0);return l.useEffect(()=>{if(n=="activeAlert"){const e=d.activeAlertsTableData.map(s=>i[s]);r(e)}else if(n=="recentlyClosedAlert"){const e=d.recentlyClosedAlertsTableData.map(s=>i[s]);r(e)}else if(n=="events"){const e=d.eventsTableData.map(s=>i[s]);r(e)}else if(n=="allActivity"){const e=d.allActivityTableData.map(s=>i[s]);r(e)}else r([])},[n]),m}function ce(){const[n,f]=l.useState(""),[c,u]=l.useState([]),[d,i]=l.useState(!1),[m,r]=l.useState("All Activity"),e=ne(m==="All Activity"?"allActivity":"recentlyClosedAlert"),{elderlyDetails:s}=l.useContext(G),[C,I]=l.useState([]),[p,h]=l.useState(1),[A,D]=l.useState(10),[E,L]=l.useState(0),[b,H]=l.useState(null),[M,g]=l.useState(!1),[y,j]=l.useState(null),x=l.useCallback(()=>{g(!0),J({to_date:"2024-11-30",from_date:Z().format("YYYY-MM-DD"),is_resolved:y,lookup:!1,elderly_id:s==null?void 0:s._id,page:p,limit:A,...b}).then(a=>{L(a.total),g(!1),I(a.data)}).catch(a=>{console.log(a),g(!1)})},[p,A,b,y,s==null?void 0:s._id]);l.useEffect(()=>{x()},[x]);function F(a){r(a),H(le(a)),h(1),a==="All Activity"&&j(null)}const R=a=>{h(a.current),D(a.pageSize)},k=a=>se(a).label,T=a=>{const o=k(a);return(o==="Critical"||o==="Warning")&&a.is_resolved===!1};C.filter(T).length;const B=()=>{i(!0)},z={selectedRowKeys:c,onChange:a=>u(a),getCheckboxProps:a=>({disabled:!T(a)})},O=a=>{j(a),h(1)};return t.jsxs("div",{id:"Elderlies",className:"w-full flex flex-col gap-4 justify-center items-center bg-white rounded-2xl p-6 mt-6",children:[t.jsxs("div",{id:"Elderlies_Header",className:"w-full flex justify-between",children:[t.jsx("h1",{className:"text-[24px] font-bold",children:"Activities History"}),t.jsxs("div",{className:"flex gap-4 h-fit items-center",children:[c.length>0&&t.jsxs(q,{type:"primary",onClick:B,style:{backgroundColor:"#252F67",borderColor:"#252F67"},children:["Resolve (",c.length,")"]}),t.jsx(v,{theme:{},children:t.jsx(w,{size:"large",options:ie,onChange:a=>F(a)})}),(m==="Critical"||m==="Warning")&&t.jsx(v,{theme:{token:{colorPrimary:"#8086AC"}},children:t.jsx(ee,{size:"large",style:{width:"120px",height:"40px",borderRadius:"10px !important"},onChange:(a,o)=>{O(a)},dropdownMatchSelectWidth:!1,placeholder:"Filter by Alert Status",value:y,options:[{label:"All Activity",value:null},{label:"Resolved",value:!0},{label:"Non-Resolved",value:!1}]})})]})]}),t.jsx(te.Provider,{value:{getLatestAlarmList:{getAlartsHistory:x}},children:t.jsx(v,{theme:{Table:{rowSelectedHoverBg:"#fff",rowSelectedBg:"#ba80f0"}},children:t.jsx(_,{rowSelection:z,columns:Array.isArray(e)?e:[],dataSource:C,rowKey:"_id",loading:M,pagination:{current:p,pageSize:A,total:E,showSizeChanger:!0,showQuickJumper:!0,showTotal:(a,o)=>`${o[0]}-${o[1]} of ${a} items`,pageSizeOptions:["10","20","50","100"]},onChange:R,locale:{emptyText:"No recent alerts"},className:"rounded-lg w-full",scroll:{x:700}})})}),t.jsx(ae,{openAlertCloseModal:d,setOpenAlertCloseModal:i,selectedAlert:c,getAlertListDatas:()=>{x(),u([])}})]})}const ie=[{label:"All Activity",value:"All Activity"},{label:"Critical",value:"Critical"},{label:"Warning",value:"Warning"}];export{ie as alertHistorySegmentOptions,ce as default};
