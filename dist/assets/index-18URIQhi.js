import{a1 as b,V as w,u as _,H as E,r as a,a2 as v,a3 as p,a4 as x,z as y,j as g,a5 as R,G as o,a6 as U}from"./index-CR4fhODd.js";import{L}from"./index-DwiEmnfM.js";function C(){const n=b();w();const i=_(),{setStoreRole:f,setUser:m}=E(),[h,k]=a.useState(!0),t=n.id.split("-"),l=()=>{const e=o.get("user"),s=U();o.get("rootToken")||(o.set("rootToken",s),o.set("rootRole",e==null?void 0:e.role))},u=e=>x(e),T=e=>{const s={super_admin:"/support-agent/dashboard/",supports_agent:"/supporter/support-agent/dashboard",nurse:"/supporter/nurse/dashboard",end_user:"/supporter/end-user/dashboard",monitoring_agency:"/ms/dashboard",elderly:`/supporter/elderlies/elderly-profile/${t[1]}?tab=overview`};i(s[e]||"/support-nurnt/dashboard")},c=e=>{o.set("user",e),o.set("mainRole",e.role),o.set("role",e.role),f({role:e.role}),m({role:e.role}),setTimeout(()=>{k(!1),T(e.sub_role||e.role)},800)},d=a.useCallback(async()=>{var e;try{const s=await v({id:t[0]});if(!((e=s==null?void 0:s.data)!=null&&e.role))throw new Error("Invalid role");if(t.length>=2){const r=await p({id:t[0],params:{role:s.data.role==="nursing_home"?"nurse":"supports_agent"}});l(),u(r.data.access_token),c({...r.data,sub_role:"elderly"})}else{const r=await p({id:t[0]});l(),u(r.data.access_token),c(s.data)}}catch(s){console.error("Error fetching user profile:",s),y.custom(r=>g.jsx(R,{t:r,title:"Error",text:s.response.data.message})),i(-1)}},[n.id]);if(a.useEffect(()=>{d()},[d]),h)return g.jsx(L,{loaderTitle:"Loading User Profile"})}export{C as default};
