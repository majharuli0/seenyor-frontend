import{u as y,r as a,$ as E,j as t,bh as N,B as j,cO as b,cP as v,bc as C,X as S,W as A,Y as O,aD as _}from"./index-CR4fhODd.js";import{E as k}from"./Elderly-D0FlUEqh.js";import{C as P}from"./CreateAndEditUsers-Dtf0D2Ik.js";import"./CustomInput-B54BPh_e.js";import"./request-BcXuuXiC.js";function T({row:u={}}){const p=y(),l=a.useContext(E),[d,i]=a.useState(!1),c=r=>{window.scrollTo(0,0),p(`/supporter/elderlies/elderly-profile/${r==null?void 0:r._id}`)};function m(){i(!0)}return t.jsxs(t.Fragment,{children:[t.jsxs(N,{children:[t.jsx(j,{type:"primary",icon:t.jsx(b,{}),onClick:()=>m(),children:"Edit"}),t.jsx(j,{icon:t.jsx(v,{}),onClick:()=>c(u),children:"View"})]}),t.jsx(P,{item:{...u,role:"elderly"},getlist:l==null?void 0:l.getlist,role:"elderly",modalOPen:d,setModalOpen:i,isEditMode:d})]})}function w(u){var x;const p=y(),l=(x=JSON.parse(localStorage.getItem("user")))==null?void 0:x.role,d=e=>{window.scrollTo(0,0),p(`/supporter/elderlies/elderly-profile/${e==null?void 0:e._id}`)},i={support_agent:["elderlyName","activeAlert","allergies","diseases","viewProfile"],nurse:["elderlyName","activeAlert","allergies","diseases","medications","viewProfile"],end_user:["elderlyName","activeAlert","allergies","diseases","medications","viewProfile"]},c={elderlyName:{title:()=>{switch(l){case"nurse":return"Resident Name";default:return"User Name"}},render:e=>t.jsx(k,{onClick:()=>d(e),data:e})},roomName:{title:"Room Name",dataIndex:"roomName",render:e=>t.jsx("span",{children:e})},activeAlert:{title:"Active Fall Alerts",dataIndex:"unresolved_alarm_count",render:e=>t.jsx("span",{children:e})},address:{title:"Address",width:"230px",render:e=>t.jsx("span",{className:"!w-[230px] text-nowrap",children:e.address})},allergies:{title:"Comments",render:e=>{var s;return t.jsx("span",{children:((s=e==null?void 0:e.comments)==null?void 0:s.map(o=>o.comment).join(", "))||"N/A"})}},diseases:{title:"Conditions",render:e=>{var s;return t.jsx("span",{children:((s=e==null?void 0:e.diseases)==null?void 0:s.map(o=>o).join(", "))||"N/A"})}},medications:{title:"Daily Routine",render:e=>{var s;return t.jsx("span",{children:(s=e.medications)==null?void 0:s.map(o=>o.name).join(", ")})}},viewOnMap:{title:"View On Map",render:e=>t.jsx("span",{className:"flex items-center transition-all duration-300 justify-start gap-2 text-sm font-medium text-text-primary hover:text-primary cursor-pointer p-2 rounded-md w-fit text-center hover:bg-slate-100",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("a",{href:`https://www.google.com/maps?q=${e.latitude},${e.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"text-base font-medium !text-blue-500",children:"View on Map"}),t.jsx(C,{size:18,className:"text-blue-500"})]})})},viewProfile:{title:"Actions",render:e=>t.jsx(T,{row:e})}},[m,r]=a.useState([]);return a.useEffect(()=>{console.log("Current role:"),console.log("Available roles:",Object.keys(i));{const e=i.support_agent.map(s=>c[s]);r(e)}},[]),m}function L(){var h;const[u,p]=a.useState(""),[l,d]=a.useState([]),[i,c]=a.useState(!1),[m,r]=a.useState({}),x=w(),e=JSON.parse(localStorage.getItem("user")),s=a.useMemo(()=>S(n=>{r(g=>({...g,name:n.trim()}))},500),[]);a.useEffect(()=>()=>s.cancel(),[s]);const o=n=>{p(n),n===""?(s.cancel(),r(g=>({...g,name:""}))):s(n)},f=a.useCallback(()=>{c(!0),A(m).then(n=>d(n)).catch(n=>console.log(n)).finally(()=>c(!1))},[m]);return a.useEffect(()=>{f()},[f]),t.jsxs("div",{id:"Elderlies",className:"w-full flex flex-col gap-4 justify-center items-center bg-white rounded-2xl p-6 mt-8",children:[t.jsxs("div",{id:"Elderlies_Header",className:"w-full flex justify-between",children:[t.jsx("h1",{className:"text-[24px] font-bold",children:(e==null?void 0:e.role)=="nurse"?"Residents":"Users"}),t.jsx("div",{className:"flex gap-4",children:t.jsx(O,{search:u,setSearch:o,placeholder:"Search Users"})})]}),t.jsx(E.Provider,{value:{total:(h=l==null?void 0:l.data)==null?void 0:h.length,page:1,SetPage:()=>{},getlist:f},children:t.jsx(_,{loading:i,columns:x,tableData:l==null?void 0:l.data})})]})}export{L as default};
