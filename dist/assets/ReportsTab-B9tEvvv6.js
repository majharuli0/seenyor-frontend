import{r as l,i as T,bO as C,j as e,C as q,D as J,gR as _,jS as E,jT as b,jU as X}from"./index-CR4fhODd.js";import Z from"./DurationStatistic-Bz6oZE4a.js";import ee from"./DurationDistribution-DxiaynL0.js";import te from"./EfficiencyStatistic-Dlk7gZBR.js";import ie from"./DeepSleepPercentageDistribution-B1Lh4qZ2.js";import ae from"./DeepSleepPercentageStatistic-Bb8fpTwz.js";import se from"./EfficiencyDistribution-DdCO9nYD.js";import re from"./ApneaIndexStatistic-RNpmqTgA.js";import oe from"./NumberOfBedExitStatistic-jTX8Vn0G.js";import le from"./DistributionOfBedExitTimes-D3kPtCBG.js";import ne from"./TimeToFallAsleepStatistic-BE8MtIXC.js";import ce from"./DistributionOfTimeToFallAsleep-fWZxf2A1.js";import me from"./DistributionOfDailyRoutine-C8ihaI_o.js";import ue from"./RespiratoryRate-BicTWF2v.js";import pe from"./HeartRate-BfqQJJgz.js";import"./Template-BLv2RFpl.js";import"./SkeletonBarChart-BNNP2f43.js";import de from"./HeartRateDistribution-CwmSH7PN.js";import fe from"./BreathRateDistribution-CLBFKbgm.js";import{C as k}from"./index-DN8cHx_b.js";import{C as A}from"./Collapse-BT_swdD9.js";import"./mockData-Bpurtgqo.js";import"./barChart-CY3WFCIy.js";import"./utiles-Cxfq-lBl.js";import"./scatterChart-ZrN1IDd9.js";import"./SkeletonScatterChart-CKYmyJt2.js";import"./SkeletonRateChart-B_Yg2cAZ.js";import"./WeeklyMonthlyPicker-BRoXS4CI.js";import"./SleepHynogram-DfUa7E06.js";import"./FileOutlined-CocyS7bT.js";import"./Cascader-C7E8ZGaw.js";import"./index-DcENZuzz.js";const{RangePicker:he}=J,{Panel:ge}=A,{SHOW_CHILD:xe}=k;function Xe(){const[De,P]=l.useState([]);T().subtract(1,"day").format("YYYY-MM-DD");const[W,O]=l.useState(),[F,H]=l.useState(T().subtract(31,"day").format("YYYY-MM-DD")),[h,L]=l.useState([]),[D,y]=l.useState(["0"]),p=l.useRef(null),N=l.useContext(C),[Y,n]=l.useState(!1),M=t=>{P(t),H(t[0]),O(t[1])},U=async()=>{if(p.current){n(!0);try{const t=await b(p.current),a=document.createElement("a");a.href=t.toDataURL("image/png"),a.download="reports.png",a.click()}catch(t){console.error("Error exporting as image:",t)}finally{n(!1)}}},I=async()=>{if(p.current){n(!0);try{const t=await b(p.current,{scale:2,useCORS:!0}),a=t.toDataURL("image/png"),o=`
          <svg xmlns="http://www.w3.org/2000/svg" width="${t.width}" height="${t.height}">
            <image href="${a}" width="${t.width}" height="${t.height}" />
          </svg>
        `,i=new Blob([o],{type:"image/svg+xml;charset=utf-8"}),s=URL.createObjectURL(i),r=document.createElement("a");r.href=s,r.download="reports.svg",r.click(),URL.revokeObjectURL(s)}catch(t){console.error("Error exporting as SVG:",t)}finally{n(!1)}}},G=async()=>{try{n(!0);const t=new X({orientation:"portrait",unit:"pt",format:"a4"}),a=t.internal.pageSize.getWidth(),o=t.internal.pageSize.getHeight(),i=15,s=2;let r=i,d=i,f=0,c=0;const S=Array.from(document.querySelectorAll(".chart"));for(let g=0;g<S.length;g++){const v=S[g],j=v.classList.contains("full-width-chart"),x=await b(v,{scale:2}),R=x.width,B=x.height,Q=x.toDataURL("image/png");let m,u,w;j?(m=a-i*2,u=B/R*m,w=2):(m=(a-i*(s+1))/s,u=B/R*m,w=1),d+u+i>o&&(t.addPage(),r=i,d=i,c=0,f=0),t.addImage(Q,"JPEG",r,d,m,u,void 0,"MEDIUM",0),j?(d+=u+i,r=i,c=0,f=0):(c===0&&(f=u),c++,r+=m+i,c===s&&(d+=f+i,r=i,c=0,f=0))}t.save("export.pdf")}catch(t){console.log(t)}finally{n(!1)}},V=[{value:"sleep",label:"Sleep",children:[{label:"Daily Sleep Duration",value:"sleepDurationStatistic"},{label:"Sleep Duration Distribution",value:"sleepDurationDistribution"},{label:"Daily Sleep Quality",value:"efficiencyStatistic"},{label:"Deep Sleep Distribution",value:"deepSleepPercentageDistribution"},{label:"Daily Deep Sleep %",value:"deepSleepPercentageStatistic"},{label:"Sleep Quality Distribution",value:"efficiencyDistribution"},{label:"Daily Sleep Disturbances",value:"apneaIndexStatistic"},{label:"Number of Bed Exits",value:"numberOfBedExitStatistic"},{label:"Bed Exit Time Trends",value:"distributionOfBedExitTimes"},{label:"Distribution of Time to Fall Asleep",value:"distributionOfTimeToFallAsleep"},{label:"Time to Fall Asleep",value:"timeToFallAsleepStatistic"},{label:"Distribution of Daily Routine",value:"distributionOfDailyRoutine"}]},{value:"health",label:"Health",children:[{label:"Daily Breathing Rate",value:"respiratoryRate"},{label:"Daily Heart Rate",value:"heartRate"},{label:"Heart Rate Distribution",value:"heartRateDistribution"},{label:"Breath Rate Distribution",value:"breathRateDistribution"}]}],$={sleepDurationStatistic:"0",sleepDurationDistribution:"0",efficiencyStatistic:"0",deepSleepPercentageDistribution:"0",deepSleepPercentageStatistic:"0",efficiencyDistribution:"0",apneaIndexStatistic:"0",numberOfBedExitStatistic:"0",distributionOfBedExitTimes:"0",timeToFallAsleepStatistic:"0",distributionOfTimeToFallAsleep:"0",distributionOfDailyRoutine:"0",respiratoryRate:"1",heartRate:"1",heartRateDistribution:"1",breathRateDistribution:"1"},z=t=>{const a=t.map(i=>i[i.length-1]);L(a);const o=new Set(D);a.forEach(i=>{const s=$[i];s&&o.add(s)}),y(Array.from(o))},K=t=>{if(h.length===0)return!0;const a=h.includes(t);return console.log(`Checking if ${t} is selected:`,a),a};return e.jsx(e.Fragment,{children:e.jsxs("div",{id:"reports",className:"flex flex-col gap-4 mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-[24px] font-bold",children:"Reports"}),e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsxs(q,{theme:{token:{fontFamily:"Baloo2",colorPrimary:"#8086AC",colorLinkActive:"#8086AC",colorLinkHover:"#8086AC",colorLink:"#8086AC"}},children:[e.jsx(he,{showTime:!1,style:{width:"200px",borderRadius:"10px"},size:"large",placeholder:["Pick Data Range (Start)","End"],format:"YYYY-MM-DD",onChange:(t,a)=>{M(a)}}),e.jsx(k,{style:{width:"300px"},options:V,placeholder:"Select Specific Analysis",multiple:!0,maxTagCount:"responsive",size:"large",showCheckedStrategy:xe,onChange:z,defaultValue:h})]}),e.jsxs(_.Button,{size:"large",style:{backgroundColor:"#fff",width:"fit-content",borderRadius:"10px"},loading:Y,menu:{items:[{label:"Export as PNG",key:"1"},{label:"Export as SVG",key:"2"}],onClick:t=>{t.key==="1"?U():t.key==="2"&&I()},icon:e.jsx(E,{})},onClick:G,children:[e.jsx(E,{}),"Export Report as PDF"]})]})]}),e.jsx(C.Provider,{value:{...N,chartFromDate:F,chartToDate:W},children:e.jsx("div",{id:"reports",ref:p,children:e.jsx(A,{activeKey:D,onChange:y,expandIconPosition:"left",children:be.map((t,a)=>e.jsx(ge,{style:{backgroundColor:"transparent"},header:e.jsxs("div",{className:"flex items-center justify-between",style:{border:"none",padding:0},children:[e.jsx("span",{children:t.groupName||"Unnamed Group"}),e.jsx("div",{className:"flex-grow mx-2",style:{borderBottom:"none"}})]}),children:e.jsx("div",{className:"gap-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2",children:t.components.map(({id:o,component:i,fullWidth:s},r)=>K(o)&&e.jsx("div",{className:s?"col-span-2 chart full-width-chart":" chart",children:i},r))})},a))})})})]})})}const be=[{groupName:"Sleep",components:[{id:"sleepDurationStatistic",component:e.jsx(Z,{isSummaryBtn:!1}),fullWidth:!1},{id:"sleepDurationDistribution",component:e.jsx(ee,{isSummaryBtn:!1}),fullWidth:!1},{id:"efficiencyStatistic",component:e.jsx(te,{isSummaryBtn:!1}),fullWidth:!1},{id:"deepSleepPercentageDistribution",component:e.jsx(ie,{isSummaryBtn:!1}),fullWidth:!1},{id:"deepSleepPercentageStatistic",component:e.jsx(ae,{isSummaryBtn:!1}),fullWidth:!1},{id:"efficiencyDistribution",component:e.jsx(se,{isSummaryBtn:!1}),fullWidth:!1},{id:"apneaIndexStatistic",component:e.jsx(re,{isSummaryBtn:!1}),fullWidth:!1},{id:"numberOfBedExitStatistic",component:e.jsx(oe,{isSummaryBtn:!1}),fullWidth:!1},{id:"distributionOfBedExitTimes",component:e.jsx(le,{isSummaryBtn:!1}),fullWidth:!0},{id:"timeToFallAsleepStatistic",component:e.jsx(ne,{isSummaryBtn:!1}),fullWidth:!1},{id:"distributionOfTimeToFallAsleep",component:e.jsx(ce,{isSummaryBtn:!1}),fullWidth:!1},{id:"distributionOfDailyRoutine",component:e.jsx(me,{isSummaryBtn:!1}),fullWidth:!0}]},{groupName:"Health",components:[{id:"respiratoryRate",component:e.jsx(ue,{isSummaryBtn:!0,dataType:"Month"}),fullWidth:!0},{id:"heartRate",component:e.jsx(pe,{isSummaryBtn:!0,dataType:"Month"}),fullWidth:!0},{id:"heartRateDistribution",component:e.jsx(de,{isSummaryBtn:!1}),fullWidth:!1},{id:"breathRateDistribution",component:e.jsx(fe,{isSummaryBtn:!1}),fullWidth:!1}]}];export{Xe as default};
